<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>ä¸€æ–‡è§£æ Linux æ“ä½œç³»ç»Ÿå¼•å¯¼å¯åŠ¨å…¨æµç¨‹ - When Art Meets Tech</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="When Art Meets Tech"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="When Art Meets Tech"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="ç†è§£ Linux æ“ä½œç³»ç»Ÿå¼€æœºå¼•å¯¼å’Œå¯åŠ¨è¿‡ç¨‹ï¼Œå¯¹äºæ“ä½œç³»ç»Ÿé…ç½®ï¼Œä»¥åŠè§£å†³ç›¸å…³å¯åŠ¨é—®é¢˜æ˜¯è‡³å…³é‡è¦çš„ã€‚"><meta property="og:type" content="blog"><meta property="og:title" content="ä¸€æ–‡è§£æ Linux æ“ä½œç³»ç»Ÿå¼•å¯¼å¯åŠ¨å…¨æµç¨‹"><meta property="og:url" content="https://www.orangeshare.cn/2015/01/26/yi-wen-jie-xi-linux-cao-zuo-xi-tong-yin-dao-qi-dong-quan-liu-cheng/"><meta property="og:site_name" content="When Art Meets Tech"><meta property="og:description" content="ç†è§£ Linux æ“ä½œç³»ç»Ÿå¼€æœºå¼•å¯¼å’Œå¯åŠ¨è¿‡ç¨‹ï¼Œå¯¹äºæ“ä½œç³»ç»Ÿé…ç½®ï¼Œä»¥åŠè§£å†³ç›¸å…³å¯åŠ¨é—®é¢˜æ˜¯è‡³å…³é‡è¦çš„ã€‚"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://s2.loli.net/2024/03/09/PrVfm7YUwD1vndq.png"><meta property="og:image" content="https://s2.loli.net/2024/03/09/kMLqdApehmTU84H.png"><meta property="og:image" content="https://s2.loli.net/2024/03/10/etU4r9AilqXF1vE.png"><meta property="og:image" content="https://s2.loli.net/2024/03/10/y7rJ8gDpaGldVCs.png"><meta property="og:image" content="https://s2.loli.net/2024/03/10/PRqn37CpzUYydkj.png"><meta property="og:image" content="https://s2.loli.net/2024/03/16/CTjHmthvGY4X7RA.png"><meta property="og:image" content="https://s2.loli.net/2024/03/10/wqrxYtD4AMyJN21.png"><meta property="og:image" content="https://s2.loli.net/2024/03/10/MYFTPadZ2rWyVbo.png"><meta property="og:image" content="https://s2.loli.net/2024/03/10/ElSRvOnb5sQ4ahr.png"><meta property="og:image" content="https://s2.loli.net/2024/03/10/cLjUYlEDhfVgsCa.png"><meta property="og:image" content="https://s2.loli.net/2024/03/10/k8wQ4aTKCbAgFqy.jpg"><meta property="og:image" content="https://s2.loli.net/2024/03/10/jYQnMRPaNBp3SiW.jpg"><meta property="og:image" content="https://s2.loli.net/2024/03/16/wHfOAuM2CvDl5cy.png"><meta property="article:published_time" content="2015-01-26T02:40:29.000Z"><meta property="article:modified_time" content="2024-03-16T12:29:24.970Z"><meta property="article:author" content="Waldeinsamkeit"><meta property="article:tag" content="Operate System"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://s2.loli.net/2024/03/09/PrVfm7YUwD1vndq.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.orangeshare.cn/2015/01/26/yi-wen-jie-xi-linux-cao-zuo-xi-tong-yin-dao-qi-dong-quan-liu-cheng/"},"headline":"When Art Meets Tech","image":["https://s2.loli.net/2024/03/09/PrVfm7YUwD1vndq.png","https://s2.loli.net/2024/03/09/kMLqdApehmTU84H.png","https://s2.loli.net/2024/03/10/etU4r9AilqXF1vE.png","https://s2.loli.net/2024/03/10/y7rJ8gDpaGldVCs.png","https://s2.loli.net/2024/03/10/PRqn37CpzUYydkj.png","https://s2.loli.net/2024/03/16/CTjHmthvGY4X7RA.png","https://s2.loli.net/2024/03/10/wqrxYtD4AMyJN21.png","https://s2.loli.net/2024/03/10/MYFTPadZ2rWyVbo.png","https://s2.loli.net/2024/03/10/ElSRvOnb5sQ4ahr.png","https://s2.loli.net/2024/03/10/cLjUYlEDhfVgsCa.png","https://s2.loli.net/2024/03/10/k8wQ4aTKCbAgFqy.jpg","https://s2.loli.net/2024/03/10/jYQnMRPaNBp3SiW.jpg","https://s2.loli.net/2024/03/16/wHfOAuM2CvDl5cy.png"],"datePublished":"2015-01-26T02:40:29.000Z","dateModified":"2024-03-16T12:29:24.970Z","author":{"@type":"Person","name":"Waldeinsamkeit"},"description":"ç†è§£ Linux æ“ä½œç³»ç»Ÿå¼€æœºå¼•å¯¼å’Œå¯åŠ¨è¿‡ç¨‹ï¼Œå¯¹äºæ“ä½œç³»ç»Ÿé…ç½®ï¼Œä»¥åŠè§£å†³ç›¸å…³å¯åŠ¨é—®é¢˜æ˜¯è‡³å…³é‡è¦çš„ã€‚"}</script><link rel="canonical" href="https://www.orangeshare.cn/2015/01/26/yi-wen-jie-xi-linux-cao-zuo-xi-tong-yin-dao-qi-dong-quan-liu-cheng/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.2.0"></head>    <body class="is-3-column">    <nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="When Art Meets Tech" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Hexo Search" href="https://hexo.io/zh-cn/"><i class="fab fa-hotjar"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><i class="fas fa-angle-double-right"></i>ä¸€æ–‡è§£æ Linux æ“ä½œç³»ç»Ÿå¼•å¯¼å¯åŠ¨å…¨æµç¨‹</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt">Â </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2015-01-26</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check">Â </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2024-03-16</time></span><span class="level-item"><a class="link-muted" href="/categories/OS/">OS</a></span><span class="level-item">41 minutes read (About 6123 words)</span></div></div><div class="content"><p>ç†è§£ Linux æ“ä½œç³»ç»Ÿå¼€æœºå¼•å¯¼å’Œå¯åŠ¨è¿‡ç¨‹ï¼Œå¯¹äºæ“ä½œç³»ç»Ÿé…ç½®ï¼Œä»¥åŠè§£å†³ç›¸å…³å¯åŠ¨é—®é¢˜æ˜¯è‡³å…³é‡è¦çš„ã€‚</p>
<a id="more"></a>

<p>æ›´å¤šç›¸å…³ç³»åˆ—åšæ–‡è¯·å‚è€ƒï¼š</p>
<p><a href="https://www.orangeshare.cn/2015/01/26/yi-wen-jie-xi-linux-cao-zuo-xi-tong-yin-dao-qi-dong-quan-liu-cheng/">ä¸€æ–‡è§£æ Linux æ“ä½œç³»ç»Ÿå¼•å¯¼å¯åŠ¨å…¨æµç¨‹</a></p>
<p><a href="https://www.orangeshare.cn/2015/02/03/yi-wen-jie-xi-linux-xi-tong-qi-dong-he-jin-cheng-guan-li/">ä¸€æ–‡è§£æ Linux ç³»ç»Ÿå¯åŠ¨å’Œè¿›ç¨‹ç®¡ç†</a></p>
<hr>
<h2 id="Linux-OS-å¼•å¯¼å¯åŠ¨æµç¨‹"><a href="#Linux-OS-å¼•å¯¼å¯åŠ¨æµç¨‹" class="headerlink" title="Linux OS å¼•å¯¼å¯åŠ¨æµç¨‹"></a>Linux OS å¼•å¯¼å¯åŠ¨æµç¨‹</h2><p>é¦–å…ˆï¼Œé€šè¿‡ Linux å¼•å¯¼å¯åŠ¨å›¾è§£æ¥äº†è§£ç³»ç»Ÿå¼•å¯¼å¯åŠ¨çš„æ•´ä¸ªæµç¨‹ï¼Œå¯ä»¥åŸºæœ¬åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<p>POST &gt;&gt;&gt; BIOS &gt;&gt;&gt; MBR &gt;&gt;&gt; GRUB &gt;&gt;&gt; Kernel &gt;&gt;&gt; Init &gt;&gt;&gt; RunLevel</p>
<p><img src="https://s2.loli.net/2024/03/09/PrVfm7YUwD1vndq.png"></p>
<p>ä¸‹é¢é€æ­¥å‰–æè¯´æ˜ç³»ç»Ÿå¼•å¯¼è¿‡ç¨‹ï¼ˆCentOS 6.9ï¼‰ï¼š</p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<h3 id="BIOS"><a href="#BIOS" class="headerlink" title="BIOS"></a>BIOS</h3><p>Linux ä¸»æœºå¼€æœºä¸Šç”µåï¼Œ<font color="orange">é¦–å…ˆä¼šåŠ è½½ä½äºä¸»æ¿ EPPROM èŠ¯ç‰‡ä¸­çš„ BIOSï¼ˆBasic Input/Output Systemï¼‰ç³»ç»Ÿå›ºä»¶ç¨‹åºï¼ˆç”¨äºåˆå§‹åŒ–ç¡¬ä»¶ç»„ä»¶ï¼‰</font>ï¼ŒåŒæ—¶ä¼šä» CMOS èŠ¯ç‰‡ä¸­è¯»å–ç”¨æˆ·è‡ªå®šä¹‰å’Œç³»ç»Ÿè‡ªåŠ¨è®°å½•çš„ BIOS é…ç½®ï¼ˆBIOS æ— æ³•å­˜å‚¨é…ç½®ï¼ŒCMOS ç”µæ± æ‰ç”µä¼šé‡ç½® BIOS è®¾ç½®ï¼‰ã€‚</p>
<p><font color="orange">ç„¶åä¼šè¿›è¡Œ POSTï¼ˆPower On Self Testï¼‰åŠ ç”µè‡ªæ£€è¿‡ç¨‹</font>ï¼ˆä¹Ÿç§°ä¸º BIOS ä¸Šç”µè‡ªæ£€ï¼‰ &gt;&gt;&gt; å°±æ˜¯æ ¹æ®ä¸»æ¿ BIOS ä¸­çš„è®¾ç½®å¯¹ä¸»æœºå„ç§ç¡¬ä»¶è®¾å¤‡ï¼ˆCPUã€Memoryã€Mainboardã€Diskã€CMOS Chipï¼‰è¿›è¡Œæ£€æµ‹ï¼Œ<font color="orange">ä»¥ç¡®è®¤ä¸»æœºç¡¬ä»¶åŸºæœ¬åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼Ÿï¼ï¼</font></p>
<p>æ­¤æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç° <font color="red">ä¸¤ç§å¼‚å¸¸æƒ…å†µ</font>ï¼š</p>
<ul>
<li>å¦‚æœå‡ºç°è‡´å‘½æ•…éšœï¼šåœæœºï¼Œå¹¶ä¸”ç”±äºåˆå§‹åŒ–è¿‡ç¨‹è¿˜æ²¡å®Œæˆï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°ä»»ä½•æç¤ºä¿¡å·ï¼›</li>
<li>å¦‚æœå‡ºç°ä¸€èˆ¬æ•…éšœï¼šä¼šå‘å‡ºå£°éŸ³ç­‰æç¤ºä¿¡å·ï¼Œç­‰å¾…æ•…éšœæ¸…é™¤ï¼›</li>
</ul>
<p>è‹¥æœªå‡ºç°æ•…éšœï¼ˆä¸»æœºç¡¬ä»¶åŸºæœ¬åŠŸèƒ½æ­£å¸¸ï¼‰ï¼Œåˆ™ POST åŠ ç”µè‡ªæ£€é€šè¿‡ã€‚</p>
<p><font color="orange">BIOS ä¸Šç”µè‡ªæ£€é€šè¿‡åï¼Œä¼šæŒ‰ç…§ BIOS ä¸­é¢„è®¾çš„å¯åŠ¨é¡ºåºï¼ˆBoot Sequence)é€ä¸€æŸ¥æ‰¾å¯å¼•å¯¼å¯åŠ¨çš„ç£ç›˜è®¾å¤‡</font>ï¼ˆHDisk/CD-ROM/Removable/Floppyï¼‰ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®å¯åŠ¨é¡ºåºå»ä¾æ¬¡æŸ¥æ‰¾ç£ç›˜è®¾å¤‡å¤´æ˜¯å¦å­˜åœ¨æœ‰æ•ˆ MBRï¼ˆMaster Boot Recordï¼‰ä¸»å¼•å¯¼è®°å½•ï¼Ÿï¼ï¼è‹¥ç¬¬ä¸€ä¸ªç£ç›˜ä¸å­˜åœ¨ MBRï¼Œåˆ™ä¼šç»§ç»­æŸ¥æ‰¾ç¬¬äºŒä¸ªç£ç›˜â€¦â€¦</p>
<p><font color="orange">æ‰¾åˆ°å¯å¼•å¯¼å¯åŠ¨çš„è®¾å¤‡åï¼ŒBIOS ä¼šå°†ç³»ç»Ÿæ§åˆ¶æƒç§»äº¤ç»™å¯å¼•å¯¼è®¾å¤‡ã€‚</font></p>
<hr>
<p>æ­¤æ—¶ï¼Œ<font color="orange">ä¼šä»å¯å¼•å¯¼è®¾å¤‡çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼ˆå¼•å¯¼æ‰‡åŒºï¼‰ä¸­è¯»å– MBR ä¸»å¼•å¯¼è®°å½•ä¿¡æ¯</font>ï¼š</p>
<h3 id="MBR"><a href="#MBR" class="headerlink" title="MBR"></a>MBR</h3><p>MBRï¼ˆMaster Boot Recordï¼‰ï¼Œå­˜å‚¨äºå¯å¼•å¯¼å¯åŠ¨ç£ç›˜çš„å¤´éƒ¨ï¼ˆ 0 ç£é“ 0 æ‰‡åŒºï¼‰ï¼Œå ç”¨ 512 å­—èŠ‚ã€‚MBR ä¸»è¦æ˜¯ç”¨æ¥å‘Šè¯‰ä»å¯å¯åŠ¨è®¾å¤‡çš„å“ªä¸ªåˆ†åŒºæ¥åŠ è½½ Boot loader å¼•å¯¼åŠ è½½ç¨‹åºã€‚</p>
<p>512 å­—èŠ‚ MBR åŒ…æ‹¬å¦‚ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>446 bytesï¼šç”¨äºå­˜å‚¨ BootLoader ç¨‹åºï¼ˆGRUB1/GRUB2/LILOâ€¦ï¼‰ï¼ŒåŒ…å«æ“ä½œç³»ç»Ÿåç§°ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸ä½ç½®ç­‰ä¿¡æ¯ï¼Œä¸»è¦åŠŸèƒ½æ˜¯åŠ è½½å†…æ ¸åˆ°å†…å­˜ä¸­è¿è¡Œï¼›</li>
<li>64 bytesï¼šç”¨äºå­˜å‚¨ Partition Tableï¼ˆåˆ†åŒºè¡¨ï¼‰ä¿¡æ¯ï¼Œæ¯ä¸ªä¸»åˆ†åŒºå ç”¨ 16 å­—èŠ‚ï¼ˆè¿™å°±æ˜¯ä¸ºå•¥ä¸€å—ç¡¬ç›˜åªèƒ½æœ‰ 4 ä¸ªä¸»åˆ†åŒºå•¦^_^ï¼‰ï¼›</li>
<li>2 bytesï¼šåˆ†åŒºè¡¨æœ‰æ•ˆæ€§æ ‡è®°</li>
</ul>
<blockquote>
<p>ä¸åŒäº MBR åˆ†åŒºæ ¼å¼ï¼Œå¯¹äºè¾ƒå¤§ç£ç›˜è®¾å¤‡çš„ GPT åˆ†åŒºæ ¼å¼ï¼Œå¼•å¯¼åŠ è½½ç¨‹åºçš„ä½ç½®ä¼šç•¥æœ‰å˜åŒ–ã€‚</p>
</blockquote>
<p><font color="orange">å°†å…¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¿è¡Œå¼•å¯¼è£…è½½å™¨/ç¨‹åº GRUB</font>ï¼ˆBoot Loader ç›®å‰å¸¸ç”¨çš„æ˜¯ GRUBï¼‰ã€‚</p>
<hr>
<h3 id="GRUB1-GRUB2"><a href="#GRUB1-GRUB2" class="headerlink" title="GRUB1/GRUB2"></a>GRUB1/GRUB2</h3><p>GRUBï¼ˆGrand Unified BootLoaderï¼‰æ˜¯å¤šç³»ç»Ÿå¯åŠ¨ç¨‹åºï¼Œå®ƒæ˜¯ç›®å‰æµè¡Œçš„å¤§éƒ¨åˆ† Linux å‘è¡Œç‰ˆæœ¬çš„ä¸»è¦å¼•å¯¼åŠ è½½ç¨‹åºï¼Œç”¨äºè®¡ç®—æœºå¯»æ‰¾æ“ä½œç³»ç»Ÿå†…æ ¸å¹¶åŠ è½½å…¶åˆ°å†…å­˜çš„æ™ºèƒ½ç¨‹åºã€‚</p>
<p>å…³äº GRUB1 &amp;&amp; GRUB2 æ›´å¤šçš„æè¿°ï¼Œå¯ä»¥å‚è§åæ–‡ã€Reff Readingã€‘ä¸­ç›¸å…³æè¿°ã€‚</p>
<p>å¯è§ï¼Œ<font color="red">GRUB çš„ä¸»è¦ç›®çš„å°±æ˜¯ &gt;&gt;&gt; æŸ¥æ‰¾å’ŒåŠ è½½ Kernel åˆ°å†…å­˜ã€‚</font></p>
<p><font color="orange">GRUB æ‰§è¡Œè¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼ˆStagesï¼‰</font>ï¼Œä»¥ GRUB1 ä¸ºä¾‹ï¼š</p>
<p><strong>[1] &gt;&gt;&gt; Stage1</strong></p>
<p><font color="green">Stage 1 ä»£ç å­˜åœ¨äº MBR åˆ†åŒºã€‚</font></p>
<p>BIOS åŠ ç”µè‡ªæ£€é€šè¿‡åï¼Œä¼šä»å¯å¼•å¯¼è®¾å¤‡çš„å¼•å¯¼æ‰‡åŒºè¯»å– MBR ä¸»å¼•å¯¼è®°å½•ï¼Œå¹¶å°†å…¶è½½å…¥å†…å­˜ï¼Œå¹¶å¼€å§‹æ‰§è¡Œ GRUB/BootLoader ä¸»ç¨‹åºã€‚</p>
<p>ç”±äºå¼•å¯¼ä»£ç ï¼ˆå³é˜¶æ®µ 1 ä»£ç ï¼‰å®é™…æ‰€å ç”¨çš„ç©ºé—´å¤§å°ä»…ä¸º 446 å­—èŠ‚ï¼ˆä¹Ÿè¢«ç§°ä¸ºå¼•å¯¼é•œåƒ [boot.img]ï¼‰ï¼Œéå¸¸çš„å°ï¼Œå®ƒä¸å¯èƒ½éå¸¸æ™ºèƒ½ã€‚<font color="orange">Stage1 çš„ä¸»è¦å·¥ä½œå°±æ˜¯æŸ¥æ‰¾å¹¶åŠ è½½ç¬¬äºŒæ®µ BootLoader ç¨‹åºï¼ˆStage2ï¼‰ã€‚</font></p>
<p>ä½†æ­¤æ—¶æ–‡ä»¶ç³»ç»Ÿè¿˜æœªæŒ‚è½½ï¼ŒMBR ä¸­åªè®°å½•äº†åˆ†åŒºè¡¨ï¼ˆåªèƒ½é€šè¿‡ MBR ä¸­çš„åˆ†åŒºè¡¨æ¥è¯†åˆ«åˆ†åŒºï¼‰ï¼Œä¸èƒ½ç†è§£æ–‡ä»¶ç³»ç»Ÿç»“æ„ï¼Œäºæ˜¯å°±æœ‰äº† stage1_5ã€‚å› æ­¤ <font color="orange">Stage1 è¿˜éœ€è¦å®šä½å¹¶åŠ è½½ Stage1_5 çš„ç¨‹åºã€‚</font></p>
<p>Stage1_5 ç¨‹åºä»£ç å¿…é¡»ä½äº MBR è®°å½•ä¹‹åã€‚</p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<p><strong>[2] &gt;&gt;&gt; Stage1_5</strong></p>
<p><font color="green">Stage1_5 ç¨‹åºå¿…é¡»ä½äº MBR å¼•å¯¼è®°å½•ä¸è®¾å¤‡ç¬¬ä¸€ä¸ªåˆ†åŒºä¹‹é—´çš„ä½ç½®ã€‚</font></p>
<p>MBRï¼ˆæ‰‡åŒº 0ï¼‰å’Œ ç¬¬ä¸€ä¸ªåˆ†åŒºï¼ˆå¼€å§‹ä½ç½®åœ¨æ‰‡åŒº 63ï¼‰ä¹‹é—´é—ç•™ä¸‹ 62 ä¸ª 512 å­—èŠ‚çš„æ‰‡åŒºï¼ˆå…± 31744 å­—èŠ‚ï¼‰ï¼Œæ­¤åŒºåŸŸæœ‰è¶³å¤Ÿå¤§å°çš„ç©ºé—´ç”¨æ¥å­˜å‚¨ Stage1_5 ç¨‹åºï¼ˆä»£ç é•œåƒ [core.img]ï¼‰</p>
<p>å› ä¸ºæœ‰æ›´å¤§çš„å­˜å‚¨ç©ºé—´ç”¨äº Stage1_5ï¼Œä¸”è¯¥ç©ºé—´è¶³å¤Ÿå®¹çº³ä¸€äº›é€šç”¨çš„æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨ç¨‹åºï¼ˆEXT/FAT/NTFSâ€¦ï¼‰ã€‚ä½ å¯ä»¥ç†è§£ä¸º <font color="orange">Stage1_5 é€šè¿‡åŠ è½½è‡ªèº«æºå¸¦çš„æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨æ¥å®ç° MBR åˆ†åŒºè¡¨ä¸­åˆ†åŒºæ–‡ä»¶ç³»ç»Ÿçš„è¯†åˆ«ï¼Œè®© Stage1 ä¸­çš„ BootLoader èƒ½è¯†åˆ« Stage2 æ‰€åœ¨åˆ†åŒºï¼ˆä¸»åˆ†åŒºï¼‰ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿã€‚</font></p>
<p>Stage1_5 æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿï¼š</p>
<p><img src="https://s2.loli.net/2024/03/09/kMLqdApehmTU84H.png"></p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<p><strong>[3] &gt;&gt;&gt; Stage2</strong></p>
<p>ç”±äºå†…æ ¸çš„ç›¸å…³æ–‡ä»¶ä½äº <code>/boot</code> ç›®å½•ä¸‹ï¼Œ<font color="green">Stage2 ç¨‹åºå¿…é¡»ä½äº boot ç›®å½•æ‰€åœ¨çš„ç£ç›˜åˆ†åŒºï¼ˆ/boot/grubï¼‰</font>ã€‚</p>
<p><font color="orange">Stage2 BootLoader ç¨‹åºä¼šæ ¹æ® <code>/boot/grub/grub.conf</code> æ–‡ä»¶æŸ¥æ‰¾ Kernel çš„ä¿¡æ¯ï¼Œç„¶åå¼€å§‹åŠ è½½ Kernel ç¨‹åºåˆ°å†…å­˜ä¸­ã€‚</font></p>
<p>å¯¹äº GRUB2 çš„ Stage2 è¿˜ä¼šä» <code>/boot/grub2/i386-pc</code> ç›®å½•ä¸‹åŠ è½½ä¸€äº›å†…æ ¸è¿è¡Œæ—¶æ¨¡å—ã€‚</p>
<p>æ¥çœ‹ä¸€ä¸‹ GRUB1 çš„é…ç½®æ–‡ä»¶ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/10/etU4r9AilqXF1vE.png"></p>
<p>å…¶ä¸­ï¼Œ<code>root (hd0,0)</code> è¿™ä¸ª root å¹¶ä¸æ˜¯çœŸæ­£çš„æ ¹ï¼Œè€Œæ˜¯ / æ‰€åœ¨çš„ä½ç½®ã€‚å¯ä»¥ç†è§£æˆ /boot æ˜¯å¤„åœ¨ <code>(hd0,0)/boot</code>ï¼Œè€Œè¿™é‡Œçš„ï¼ˆhd0,0) æŒ‡çš„æ˜¯ç¬¬ä¸€ä¸ªç£ç›˜çš„ç¬¬ä¸€ä¸ªåˆ†åŒºã€‚</p>
<p><font color="orange">å½“ Kernel ç¨‹åºè¢«æ£€æµ‹å¹¶åœ¨åŠ è½½åˆ°å†…å­˜ä¸­ï¼ŒGRUB å°±å°†æ§åˆ¶æƒäº¤æ¥ç»™ äº† Kernel ç¨‹åºã€‚</font></p>
<hr>
<h3 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h3><p>Kernel å†…æ ¸æ–‡ä»¶å¾ˆå°ï¼Œåªä¿ç•™äº†æœ€åŸºæœ¬çš„æ¨¡å—ï¼Œä»¥ä¸€ç§è‡ªè§£å‹çš„å‹ç¼©æ ¼å¼å­˜å‚¨ä»¥èŠ‚çœç©ºé—´ï¼Œå®ƒä¸ä¸€ä¸ªåˆå§‹åŒ–çš„è™šæ‹Ÿå†…å­˜ç£ç›˜æ˜ åƒå’Œå­˜å‚¨è®¾å¤‡æ˜ å°„è¡¨éƒ½å­˜å‚¨äº <code>/boot</code> ç›®å½•ä¹‹ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">initramfs-3.10.0-1127.el7.x86_64.img</span><br><span class="line">System.map-3.10.0-1127.el7.x86_64</span><br><span class="line">vmlinuz-0-rescue-b7ee23f3e71aae428045b321afa67185</span><br><span class="line">vmlinuz-3.10.0-1127.el7.x86_64</span><br></pre></td></tr></table></figure>

<p><font color="orange">é€‰å®šçš„å†…æ ¸è¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œé¦–å…ˆå¿…é¡»ä»å‹ç¼©æ ¼å¼è§£å‹è‡ªèº«</font>ï¼Œæ¥ä¸‹æ¥å†…æ ¸å°†ä¼šæ¥ç®¡æ§åˆ¶å¹¶å®Œæˆ &gt;&gt;&gt;  æ¢æµ‹ç¡¬ä»¶ â€“&gt; åŠ è½½é©±åŠ¨ â€“&gt; æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ â€“&gt; åˆ‡æ¢è‡³æ ¹æ–‡ä»¶ç³»ç»Ÿï¼ˆrootfsï¼‰â€“&gt; è¿è¡Œ /sbin/init å®Œæˆç³»ç»Ÿåˆå§‹åŒ–ã€‚</p>
<p>æµç¨‹æ²¡æœ‰é—®é¢˜ï¼Œä½†ç”±äº <font color="red">Kernel ä¸ºäº†ç²¾ç®€ï¼Œåªä¿ç•™äº†æœ€åŸºæœ¬çš„æ¨¡å—ï¼Œå¹¶æ²¡æœ‰å„ç§ç¡¬ä»¶æˆ–æ–‡ä»¶ç³»ç»Ÿçš„é©±åŠ¨ç¨‹åºï¼Œå°±æ— æ³•è¯†åˆ« rootfs æ‰€åœ¨çš„è®¾å¤‡ï¼Œæ•…äº§ç”Ÿäº† initrdï¼ˆInitial RAM Diskï¼‰è¿™ä¸ªè™šæ‹Ÿå†…å­˜ç£ç›˜é•œåƒæ–‡ä»¶ã€‚</font></p>
<p>äº‹å®ä¸Šï¼Œä¸Šé¢ GRUB åœ¨åŠ è½½å†…æ ¸åŒæ—¶ï¼ˆStage2ï¼‰ï¼Œä¹ŸæŠŠ initrd åŠ è½½åˆ°å†…å­˜ä¸­å¹¶è¿è¡Œï¼Œäº§ç”Ÿä¸€ä¸ªä¸´æ—¶çš„è™šæ‹Ÿæ ¹æ–‡ä»¶ç³»ç»Ÿï¼ˆrootfsï¼‰æ¥æ›¿ä»£çœŸå®çš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŒ‚è½½ initramfs.img æ–¹æ³•</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> mkdir /home/centos/temp</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cp /boot/initramfs-3.10.0-1127.el7.x86_64.img /home/centos/temp/initrd.gz -a</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /home/centos/temp</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> gunzip ./initrd.gz</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cpio -ivmd &lt; ./initrd</span></span><br></pre></td></tr></table></figure>

<p>initrd æ–‡ä»¶å±•å¼€åçš„ç›®å½•å¦‚ä¸‹ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/10/y7rJ8gDpaGldVCs.png"></p>
<p>Linux æ ¹ç›®å½•ä¸‹æ–‡ä»¶ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/10/PRqn37CpzUYydkj.png"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œinitrd æ–‡ä»¶å…¶å®æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„æ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œé‡Œé¢åŒ…å« binã€libã€lib64ã€sysã€varã€etcã€sysrootã€ devã€procã€tmp ç­‰æ ¹ç›®å½•ï¼Œå…¶ä¸­è£…è½½äº†å¿…è¦çš„é©±åŠ¨æ¨¡å—ã€‚å°†å†…æ ¸ä¸çœŸæ­£çš„æ ¹å»ºç«‹è”ç³»ï¼Œå†…æ ¸é€šè¿‡å®ƒåŠ è½½æ ¹æ–‡ä»¶ç³»ç»Ÿçš„é©±åŠ¨ç¨‹åºï¼Œç„¶åä»¥è¯»å†™æ–¹å¼æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<p><font color="orange">å½“ Kernel åŠ è½½å¯åŠ¨æ—¶ï¼Œå¯ä»¥ä» initrd æ–‡ä»¶ä¸­è£…è½½é©±åŠ¨æ¨¡å—ï¼Œç›´åˆ°æŒ‚è½½çœŸæ­£çš„ rootfsï¼Œç„¶åå°† initrd ä»å†…å­˜ä¸­ç§»é™¤ã€‚å½“æ ¹æ–‡ä»¶ç³»ç»Ÿè¢«æŒ‚è½½åï¼Œå¼€å§‹è£…è½½ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼ˆ/sbin/initï¼‰&lt;&lt;&lt; pid=1ï¼Œä¹‹åå°±å°†æ§åˆ¶æƒäº¤æ¥ç»™äº† System V init ç¨‹åºã€‚</font></p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<p><font color="red">â†“â†“â†“â†“â†“â†“ SystemV &amp;&amp; Upstart &amp;&amp; Systemd â†“â†“â†“â†“â†“â†“</font></p>
<p>Linux ç³»ç»Ÿä¸­æ”¯æŒä¸‰ç§ Init æ–¹å¼ï¼š</p>
<ul>
<li>System V initializationï¼šLinux æœ€å¤è€ã€æœ€å¹¿ä¸ºæµä¼ çš„ï¼ˆä¸²è¡Œæ‰§è¡Œ shell è„šæœ¬å¯åŠ¨æœåŠ¡ï¼‰åˆå§‹åŒ–ç³»ç»Ÿ</li>
<li>Upstartï¼šæ˜¯ä¸€ä¸ªä½¿ç”¨åŸºäºäº‹ä»¶ï¼ˆEventï¼‰çš„ System-V Init åˆå§‹åŒ–ç³»ç»Ÿçš„æ›¿ä»£å“ï¼›æœ€åˆä¸º Ubuntu å‘è¡Œç‰ˆå¼€å‘ï¼Œä»¥é€‚åˆæ‰€æœ‰ Linux å‘è¡Œç‰ˆä¸ºç›®æ ‡çš„</li>
<li>Systemdï¼šæ˜¯æ–°ä¸€ä»£çš„ï¼ˆå¹¶è¡Œå¯åŠ¨æœåŠ¡è¿›ç¨‹ï¼‰åˆå§‹åŒ–ç³»ç»Ÿï¼Œå·²æˆä¸ºç›®å‰å¤§å¤šæ•° Linux å‘è¡Œç‰ˆï¼ˆCentOS 7/Ubuntuï¼‰ä¸­æµè¡Œä¸”å¹¿æ³›é€‚åº”çš„æ ‡å‡†åˆå§‹åŒ–ç³»ç»Ÿï¼Œå¤§æœ‰å–ä»£ Upstart ä¹‹åŠ¿ï¼›</li>
</ul>
<p>Systemd è¿è¡Œçš„ç¬¬ä¸€ä¸ª init è¿›ç¨‹æ˜¯ï¼ˆ/lib/systemd/systemd æˆ– /usr/lib/systemd/systemdï¼‰ï¼›è€Œ Upstart è¿è¡Œç¬¬ä¸€ä¸ª init è¿›ç¨‹æ˜¯ Upstart initï¼ˆ/sbin/init splashï¼‰ã€‚</p>
<hr>
<p>ä»¥ System V initialization ä¸ºä¾‹ï¼š</p>
<h3 id="Init"><a href="#Init" class="headerlink" title="Init"></a>Init</h3><p><font color="orange">æŒ‚è½½å®Œæˆæ ¹æ–‡ä»¶ç³»ç»Ÿä¹‹åï¼Œæ‰§è¡Œç¬¬ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹ init &gt;&gt;&gt; /sbin/initï¼ˆæ‰€æœ‰è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ï¼‰ï¼Œç„¶åå¼€å§‹è¿›è¡Œ OS åˆå§‹åŒ–ã€‚</font></p>
<p>/etc ç›®å½•ä¸‹çš„ init ç›¸å…³çš„è„šæœ¬ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/16/CTjHmthvGY4X7RA.png"></p>
<p>init é¦–å…ˆè¿è¡Œ <code>/etc/init/rcS.conf</code> è„šæœ¬ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/10/wqrxYtD4AMyJN21.png"></p>
<p>å¯è§ï¼Œåœ¨  rcS.conf è„šæœ¬ä¸­é¦–å…ˆè°ƒç”¨äº† <code>/etc/rc.d/rc.sysinit</code> è¿›è¡Œç³»ç»Ÿçš„åˆå§‹åŒ–è®¾ç½®ï¼Œæ¥çœ‹çœ‹ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/10/MYFTPadZ2rWyVbo.png"></p>
<p>äº‹å®ä¸Šï¼Œinit æ‰§è¡Œ /etc/rc.d/rc.sysinit çš„åˆå§‹åŒ–å°†ä¼šåšå¾ˆå¤šè®¾ç½®ï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1ã€è·å¾—ç½‘ç»œç¯å¢ƒ </span><br><span class="line">2ã€æŒ‚è½½è®¾å¤‡ </span><br><span class="line">3ã€å¼€æœºå¯åŠ¨ç”»é¢Plymouthï¼ˆå–æ›¿äº†è¿‡å¾€çš„ RHGBï¼‰ </span><br><span class="line">4ã€åˆ¤æ–­æ˜¯å¦å¯ç”¨SELinux </span><br><span class="line">5ã€æ˜¾ç¤ºäºå¼€æœºè¿‡ç¨‹ä¸­çš„æ¬¢è¿ç”»é¢ </span><br><span class="line">6ã€åˆå§‹åŒ–ç¡¬ä»¶ </span><br><span class="line">7ã€ç”¨æˆ·è‡ªå®šä¹‰æ¨¡å—çš„åŠ è½½ </span><br><span class="line">8ã€é…ç½®å†…æ ¸çš„å‚æ•° </span><br><span class="line">9ã€è®¾ç½®ä¸»æœºå </span><br><span class="line">10ã€åŒæ­¥å­˜å‚¨å™¨ </span><br><span class="line">11ã€è®¾å¤‡æ˜ å°„å™¨åŠç›¸å…³çš„åˆå§‹åŒ– </span><br><span class="line">12ã€åˆå§‹åŒ–è½¯ä»¶ç£ç›˜é˜µåˆ—ï¼ˆRAIDï¼‰ </span><br><span class="line">13ã€åˆå§‹åŒ– LVM çš„æ–‡ä»¶ç³»ç»ŸåŠŸèƒ½ </span><br><span class="line">14ã€æ£€éªŒç£ç›˜æ–‡ä»¶ç³»ç»Ÿï¼ˆfsckï¼‰ </span><br><span class="line">15ã€è®¾ç½®ç£ç›˜é…é¢(quota) </span><br><span class="line">16ã€é‡æ–°ä»¥å¯è¯»å†™æ¨¡å¼æŒ‚è½½ç³»ç»Ÿç£ç›˜ </span><br><span class="line">17ã€æ›´æ–°quotaï¼ˆéå¿…è¦ï¼‰ </span><br><span class="line">18ã€å¯åŠ¨ç³»ç»Ÿè™šæ‹Ÿéšæœºæ•°ç”Ÿæˆå™¨ </span><br><span class="line">19ã€é…ç½®æœºå™¨ï¼ˆéå¿…è¦ï¼‰ </span><br><span class="line">20ã€æ¸…é™¤å¼€æœºè¿‡ç¨‹å½“ä¸­çš„ä¸´æ—¶æ–‡ä»¶ </span><br><span class="line">21ã€åˆ›å»ºICEç›®å½• </span><br><span class="line">22ã€å¯åŠ¨äº¤æ¢åˆ†åŒºï¼ˆswapï¼‰ </span><br><span class="line">23ã€å°†å¼€æœºä¿¡æ¯å†™å…¥/var/log/dmesgæ–‡ä»¶ä¸­</span><br></pre></td></tr></table></figure>

<p><font color="orange">æ‰§è¡Œç³»ç»Ÿåˆå§‹åŒ–åï¼Œä¼šæ‰§è¡Œ /etc/inittab æ¥è®¾å®šç³»ç»Ÿè¿è¡Œçš„é»˜è®¤çº§åˆ«</font>ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/10/ElSRvOnb5sQ4ahr.png"></p>
<p>å¯è§ï¼ŒLinux ç³»ç»Ÿä¸­å…±æœ‰ [0-6] ä¸ƒä¸ªè¿è¡Œçº§åˆ«ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„ç™»å½•æ¨¡å¼ã€‚</p>
<p>å…³äº Systemd/Upstart å·¥å…·å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹è¿›è¡Œç³»ç»Ÿåˆå§‹åŒ–ï¼Œå¯ä»¥å‚è§åæ–‡ã€Reff Readingã€‘ä¸­ç›¸å…³æè¿°ã€‚</p>
<hr>
<h3 id="RunLevel"><a href="#RunLevel" class="headerlink" title="RunLevel"></a>RunLevel</h3><p>Runlevel è¿è¡Œçº§åˆ«ï¼Œä¸åŒçš„è¿è¡Œçº§åˆ«ä¸‹ï¼Œç³»ç»Ÿä¼šå¯åŠ¨çš„ä¸ä¸€æ ·æœåŠ¡ã€‚</p>
<p><font color="orange">è®¾å®šç©ç³»ç»Ÿé»˜è®¤è¿è¡Œçº§åˆ«ä»¥åï¼Œæ¥ç€è°ƒç”¨ /etc/rc.d/rc è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬ä¼šæ ¹æ®é»˜è®¤è¿è¡Œçº§åˆ«å‚æ•°ï¼Œåˆ†åˆ«æ‰§è¡Œ /etc/rc.d/rcN.d ç›®å½•ä¸‹çš„ä¸åŒè„šæœ¬</font>ï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Run level 0 â€“ /etc/rc.d/rc0.d/</span><br><span class="line">Run level 1 â€“ /etc/rc.d/rc1.d/</span><br><span class="line">Run level 2 â€“ /etc/rc.d/rc2.d/</span><br><span class="line">Run level 3 â€“ /etc/rc.d/rc3.d/</span><br><span class="line">Run level 4 â€“ /etc/rc.d/rc4.d/</span><br><span class="line">Run level 5 â€“ /etc/rc.d/rc5.d/</span><br><span class="line">Run level 6 â€“ /etc/rc.d/rc6.d/</span><br></pre></td></tr></table></figure>

<p>ç›®å½•åä¸­çš„ <code>rc</code> è¡¨ç¤º â€œrun commandâ€ï¼›<code>d</code> è¡¨ç¤º directoryã€‚è¿è¡Œç¨‹åºç›®å½•ä¸‹çš„è„šæœ¬åªæœ‰ K å’Œ S å¼€å¤´çš„æ–‡ä»¶ï¼šK å¼€å¤´çš„æ–‡ä»¶ä¸ºå¼€æœºéœ€è¦æ‰§è¡Œå…³é—­çš„æœåŠ¡ï¼ŒS å¼€å¤´çš„æ–‡ä»¶ä¸ºå¼€æœºéœ€è¦æ‰§è¡Œå¼€å¯çš„æœåŠ¡ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/10/cLjUYlEDhfVgsCa.png"></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ºäº†æ–¹åˆ«ç³»ç»Ÿç®¡ç†æ›´æ–°ï¼Œä¸ƒä¸ª <code>/etc/rc.d/rcN.d</code> ç›®å½•é‡Œåˆ—å‡ºçš„ç¨‹åºï¼Œéƒ½è®¾ä¸ºé“¾æ¥æ–‡ä»¶ï¼Œå…¨éƒ¨æŒ‡å‘å¦å¤–ä¸€ä¸ªç›®å½• <code>/etc/rc.d/init.d</code>ï¼ˆd è¡¨ç¤ºç›®å½•ï¼Œä¸ç¨‹åº init åŒºåˆ†ï¼‰ã€‚é€šè¿‡è¿™ä¸€ç‰¹æ€§ï¼Œå¦‚æœä½ è¦æ‰‹åŠ¨å…³é—­æˆ–é‡å¯æŸä¸ªè¿›ç¨‹ï¼Œç›´æ¥åˆ°ç›®å½• /etc/init.d ä¸­å¯»æ‰¾å¯åŠ¨è„šæœ¬ï¼ˆä»¥ç½‘ç»œæœåŠ¡ä¸ºä¾‹ï¼‰ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo /etc/init.d/network restart</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo /etc/init.d/network stop</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo /etc/init.d/network start</span></span><br></pre></td></tr></table></figure>

<p>æœ€åä¼šæ‰§è¡Œ <code>/etc/rc.d/rc.local</code> è¿™ä¸ªè„šæœ¬ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å°†ä¸€äº›æ‰§è¡Œå‘½ä»¤æˆ–è€…è„šæœ¬å†™åˆ°å…¶ä¸­ï¼Œå½“å¼€æœºæ—¶å°±å¯ä»¥åŠ è½½ã€‚</p>
<p><font color="orange">æœ€åæ‰§è¡Œå®Œ /etc/rc.d/rc.local è„šæœ¬åï¼Œç³»ç»Ÿå¯åŠ¨å®Œæˆ</font>~~~</p>
<hr>
<h3 id="Login-In"><a href="#Login-In" class="headerlink" title="Login In"></a>Login In</h3><p>ç³»ç»Ÿå¼•å¯¼å¯åŠ¨ã€åˆå§‹åŒ–å®Œæˆåï¼ŒInit ç»™å‡ºç”¨æˆ·ç™»å½•æç¤ºç¬¦ï¼ˆloginï¼‰æˆ–è€…å›¾å½¢åŒ–ç™»å½•ç•Œé¢ï¼Œç­‰å¾…ç”¨æˆ·ç™»å…¥ã€‚</p>
<p>ç”¨æˆ·è¾“å…¥ç”¨æˆ·å’Œå¯†ç ç™»é™†åï¼Œç³»ç»Ÿä¼šä¸ºç”¨æˆ·åˆ†é…ä¸€ä¸ªç”¨æˆ· IDï¼ˆuidï¼‰å’Œç»„ IDï¼ˆgidï¼‰ï¼Œè¿™ä¸¤ä¸ª ID æ˜¯ç”¨æˆ·çš„èº«ä»½æ ‡è¯†ï¼Œç”¨äºæ£€æµ‹ç”¨æˆ·è¿è¡Œç¨‹åºæ—¶çš„èº«ä»½éªŒè¯ã€‚</p>
<p><font color="orange">ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œæ•´ä¸ªç³»ç»Ÿå¯åŠ¨æµç¨‹è¿è¡Œå®Œæ¯•ï¼ï¼ï¼</font></p>
<hr>
<h2 id="Reff-Reading"><a href="#Reff-Reading" class="headerlink" title="Reff Reading"></a>Reff Reading</h2><p>æ¨èé˜…è¯»éƒ¨åˆ†ï¼Œé€šè¿‡è¿™ä¸€ç« èŠ‚çš„é˜…è¯»å¯ä»¥å¸®åŠ©ä½ æ›´å¥½çš„ç†è§£ Linux ç³»ç»Ÿå¼•å¯¼å¯åŠ¨çš„å…¨æµç¨‹ï¼š</p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<h3 id="å…³äº-GRUB1-GRUB2"><a href="#å…³äº-GRUB1-GRUB2" class="headerlink" title="å…³äº GRUB1/GRUB2"></a>å…³äº GRUB1/GRUB2</h3><p>GRUBï¼ˆGrand Unified BootLoaderï¼‰æ˜¯å¤šç³»ç»Ÿå¯åŠ¨ç¨‹åºï¼Œå®ƒæ˜¯ç›®å‰æµè¡Œçš„å¤§éƒ¨åˆ† Linux å‘è¡Œç‰ˆæœ¬çš„ä¸»è¦å¼•å¯¼åŠ è½½ç¨‹åºï¼Œç”¨äºè®¡ç®—æœºå¯»æ‰¾æ“ä½œç³»ç»Ÿå†…æ ¸å¹¶åŠ è½½å…¶åˆ°å†…å­˜çš„æ™ºèƒ½ç¨‹åºã€‚</p>
<p>GRUB2 è·Ÿ GRUB1 ç±»ä¼¼ï¼Œæ”¯æŒä» Linux å†…æ ¸é€‰æ‹©ä¹‹ä¸€å¼•å¯¼å¯åŠ¨ã€‚Red Hat åŒ…ç®¡ç†å™¨ï¼ˆDNFï¼‰æ”¯æŒä¿ç•™å¤šä¸ªå†…æ ¸ç‰ˆæœ¬ï¼Œä»¥é˜²æœ€æ–°ç‰ˆæœ¬å†…æ ¸å‘ç”Ÿé—®é¢˜è€Œæ— æ³•å¯åŠ¨æ—¶ï¼Œå¯ä»¥æ¢å¤è€ç‰ˆæœ¬çš„å†…æ ¸ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒGRUB æä¾›äº†ä¸€ä¸ªå·²å®‰è£…å†…æ ¸çš„é¢„å¼•å¯¼èœå•ï¼ˆGUN GRUB ç•Œé¢ï¼‰ï¼Œå…¶ä¸­åŒ…æ‹¬é—®é¢˜è¯Šæ–­èœå•ï¼ˆrecuseï¼‰ä»¥åŠæ¢å¤èœå•ï¼ˆå¦‚æœå·²ç»é…ç½®æ¢å¤é•œåƒï¼‰ã€‚GRUB1 èƒ½å¤Ÿé€šè¿‡æ–‡ä»¶ <code>/boot/grub/grub.conf</code> è¿›è¡Œé…ç½®ã€‚GRUB2 é€šè¿‡ <code>/boot/grub2/grub.cfg</code> è¿›è¡Œé…ç½®ã€‚</p>
<p>GRUB1 ç°åœ¨å·²ç»é€æ­¥è¢«å¼ƒç”¨ï¼Œåœ¨å¤§å¤šæ•°ç°ä»£å‘è¡Œç‰ˆä¸Šå®ƒå·²ç»è¢« GRUB2 æ‰€æ›¿æ¢ï¼ŒGRUB2 æ˜¯åœ¨ GRUB1 çš„åŸºç¡€ä¸Šé‡å†™å®Œæˆã€‚åŸºäº Red Hat çš„å‘è¡Œç‰ˆå¤§çº¦æ˜¯åœ¨ Fedora 15 å’Œ CentOS/RHEL 7 æ—¶å‡çº§åˆ° GRUB2 çš„ã€‚GRUB2 æä¾›äº†ä¸ GRUB1 åŒæ ·çš„å¼•å¯¼åŠŸèƒ½ï¼Œä½†æ˜¯ GRUB2 ä¹Ÿæ˜¯ä¸€ä¸ª <font color="green">ç±»ä¼¼ä¸»æ¡†æ¶ï¼ˆmainframeï¼‰ç³»ç»Ÿä¸Šçš„åŸºäºå‘½ä»¤è¡Œçš„å‰ç½®æ“ä½œç³»ç»Ÿï¼ˆPre-OSï¼‰ç¯å¢ƒï¼Œä½¿å¾—åœ¨é¢„å¼•å¯¼é˜¶æ®µé…ç½®æ›´ä¸ºæ–¹ä¾¿å’Œæ˜“æ“ä½œï¼ˆgrub &gt;ï¼‰ã€‚</font></p>
<p>ä¸¤ä¸ªç‰ˆæœ¬çš„ GRUB çš„åŸºæœ¬å·¥ä½œæ–¹å¼ä¸€è‡´ï¼Œå…¶ä¸»è¦é˜¶æ®µä¹Ÿä¿æŒç›¸åŒï¼Œéƒ½å¯åˆ†ä¸º 3 ä¸ªé˜¶æ®µã€‚</p>
<hr>
<h3 id="Systemd-å¯åŠ¨æµç¨‹åˆ†æ"><a href="#Systemd-å¯åŠ¨æµç¨‹åˆ†æ" class="headerlink" title="Systemd å¯åŠ¨æµç¨‹åˆ†æ"></a>Systemd å¯åŠ¨æµç¨‹åˆ†æ</h3><p>Systemd æ˜¯æ–°ä¸€ä»£çš„åˆå§‹åŒ–ç³»ç»Ÿï¼ˆå¹¶è¡Œå¯åŠ¨æœåŠ¡è¿›ç¨‹ï¼‰ï¼Œå·²æˆä¸ºç›®å‰å¤§å¤šæ•° Linux å‘è¡Œç‰ˆï¼ˆCentOS 7/Ubuntuï¼‰ä¸­æµè¡Œä¸”å¹¿æ³›é€‚åº”çš„æ ‡å‡†åˆå§‹åŒ–ç³»ç»Ÿï¼Œå¤§æœ‰å–ä»£ Upstart ä¹‹åŠ¿ã€‚</p>
<p><font color="orange">Systemd è¿è¡Œçš„ç¬¬ä¸€ä¸ª Init è¿›ç¨‹æ˜¯ï¼ˆ/lib/systemd/systemd æˆ– /usr/lib/systemd/systemdï¼‰&lt;&lt;&lt; pid=1ï¼Œæ˜¯æ‰€æœ‰è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ã€‚</font></p>
<p>Systemd Init è¿›ç¨‹ä¼šæ ¹æ®å…¶é…ç½®æ–‡ä»¶ï¼ˆ<code>/etc/systemd/system/default.target</code>ï¼‰ï¼Œå†³å®š Linux ç³»ç»Ÿåº”è¯¥å¯åŠ¨è¾¾åˆ°å“ªä¸ªç›®æ ‡æ€ï¼ˆTargetï¼‰ï¼Ÿï¼ï¼å¹¶ä¸”é€’å½’çš„å¤„ç†å®ƒçš„ä¾èµ–å…³ç³»ã€‚</p>
<p>é»˜è®¤ç›®æ ‡æ€ä¸€èˆ¬ä¸ºï¼š<code>graphical.targetï¼ˆRunLevel 5ï¼‰</code> æˆ–è€… <code>multi-user.targetï¼ˆRunLevel 3ï¼‰</code>ï¼Œä¸‹å›¾å±•ç¤ºå…³é”®æœåŠ¡é…ç½®çš„å¯åŠ¨ä¾èµ–ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/10/k8wQ4aTKCbAgFqy.jpg"></p>
<p>ä¸‹é¢é€æ­¥å‰–æè¯´æ˜ systemd å¯åŠ¨çš„ 4 ä¸ªå…³é”®æ­¥éª¤ï¼š</p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<p><strong>[Step 1] &gt;&gt;&gt;</strong> <font color="orange">systemd æ‰§è¡Œé»˜è®¤ default.target é…ç½®ï¼Œå†³å®š Linux ç³»ç»Ÿåº”è¯¥å¯åŠ¨è¾¾åˆ°å“ªä¸ªç›®æ ‡æ€ï¼ˆTargetï¼‰</font></p>
<p><code>default.target</code> æ˜¯ä¸€ä¸ªæŒ‡å‘çœŸå®çš„ target æ–‡ä»¶çš„ç¬¦å·é“¾æ¥ï¼š</p>
<ul>
<li>å¯¹äºæ¡Œé¢ç³»ç»Ÿï¼Œå…¶é“¾æ¥åˆ° <code>graphical.target</code>ï¼Œè¯¥æ–‡ä»¶ç›¸å½“äºæ—§å¼ SystemV Init æ–¹å¼çš„ <code>runlevel 5</code>ï¼›</li>
<li>å¯¹äºä¸€ä¸ªæœåŠ¡å™¨æ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œdefault.target æ›´å¤šæ˜¯é»˜è®¤é“¾æ¥åˆ° <code>multi-user.target</code>ï¼Œ ç›¸å½“äº SystemV Init ç³»ç»Ÿçš„ <code>runlevel 3</code>ï¼›</li>
<li>emergency.target ç›¸å½“äºå•ç”¨æˆ·æ¨¡å¼ã€‚</li>
</ul>
<p>systemd å¯åŠ¨çš„ç›®æ ‡æ€ï¼ˆtargetï¼‰å’Œè€ç‰ˆ SystemV Init å¯åŠ¨è¿è¡Œçº§åˆ«ï¼ˆrunlevelï¼‰çš„å¯¹æ¯”ï¼š</p>
<p><img src="https://s2.loli.net/2024/03/10/jYQnMRPaNBp3SiW.jpg"></p>
<p>å…¶ä¸­çš„ï¼Œ<strong>systemd ç›®æ ‡æ€åˆ«å</strong> æ˜¯ä¸ºäº† systemd å‘å‰å…¼å®¹ systemV Init è€Œæä¾›ã€‚è¿™ä¸ªç›®æ ‡æ€åˆ«åå…è®¸ç³»ç»Ÿç®¡ç†å‘˜ï¼ˆåŒ…æ‹¬æˆ‘è‡ªå·±ï¼‰ç”¨ systemV å‘½ä»¤ï¼ˆä¾‹å¦‚ init 3ï¼‰æ”¹å˜è¿è¡Œçº§åˆ«ã€‚å½“ç„¶ï¼Œè¯¥ <font color="red">systemV å‘½ä»¤æ˜¯è¢«è½¬å‘åˆ° systemd è¿›è¡Œè§£é‡Šå’Œæ‰§è¡Œçš„ã€‚</font></p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<p><strong>[Step 2] &gt;&gt;&gt;</strong> <font color="orange">systemd æ‰§è¡Œå¯åŠ¨ default.target æ‰€ä¾èµ–çš„ç›®æ ‡ basic.target å’Œ sysinit.target åˆå§‹åŒ–ç³»ç»Ÿ</font></p>
<p>ä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹ä¾èµ–ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat /etc/systemd/system/default.target</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  This file is part of systemd.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash"><span class="comment">#  systemd is free software; you can redistribute it and/or modify it</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">  under the terms of the GNU Lesser General Public License as published by</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  the Free Software Foundation; either version 2.1 of the License, or</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  (at your option) any later version.</span></span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=Graphical Interface</span><br><span class="line">Documentation=man:systemd.special(7)</span><br><span class="line">Requires=multi-user.target</span><br><span class="line">Wants=display-manager.service</span><br><span class="line">Conflicts=rescue.service rescue.target</span><br><span class="line">After=multi-user.target rescue.service rescue.target display-manager.service</span><br><span class="line">AllowIsolate=yes</span><br></pre></td></tr></table></figure>

<p>After ä¸­æŒ‡å®šçš„ target éœ€è¦åœ¨ default.target ä¹‹å‰è¿è¡Œã€‚</p>
<p>ğŸ‘‡ğŸ‘‡ğŸ‘‡ <strong>å…³äºçŠ¶æ€æ£€æŸ¥ç‚¹</strong> ğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<p><font color="green"><code>sysinit.target</code> å’Œ <code>basic.target</code> ç›®æ ‡æ€å¯ä»¥è¢«è§†ä½œå¯åŠ¨è¿‡ç¨‹ä¸­çš„çŠ¶æ€æ£€æŸ¥ç‚¹ã€‚</font></p>
<p>å°½ç®¡ systemd çš„è®¾è®¡åˆè¡·æ˜¯å¹¶è¡Œå¯åŠ¨ç³»ç»ŸæœåŠ¡ï¼Œä½†æ˜¯éƒ¨åˆ†æœåŠ¡æˆ–ç›®æ ‡æ€æ˜¯å…¶å®ƒæœåŠ¡æˆ–ç›®æ ‡æ€çš„å¯åŠ¨çš„å‰æã€‚å› æ­¤ï¼Œç³»ç»Ÿå°†æš‚åœäº æ£€æŸ¥ç‚¹ ç›´åˆ°å…¶æ‰€è¦æ±‚çš„æœåŠ¡å’Œç›®æ ‡æ€éƒ½æ»¡è¶³ä¸ºæ­¢ã€‚</p>
<p><font color="red">For sysinit.target çŠ¶æ€</font></p>
<p>sysinit.target çŠ¶æ€çš„åˆ°è¾¾ï¼Œæ˜¯ä»¥å…¶æ‰€ä¾èµ–çš„æ‰€æœ‰èµ„æºæ¨¡å—éƒ½æ­£å¸¸å¯åŠ¨ä¸ºå‰æçš„ï¼Œå¦‚ï¼šæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ã€äº¤æ¢æ–‡ä»¶è®¾ç½®ã€è®¾å¤‡ç®¡ç†å™¨çš„å¯åŠ¨ã€éšæœºæ•°ç”Ÿæˆå™¨ç§å­è®¾ç½®ã€ä½çº§åˆ«ç³»ç»ŸæœåŠ¡åˆå§‹åŒ–ã€åŠ è§£å¯†æœåŠ¡å¯åŠ¨ç­‰éƒ½å¿…é¡»å®Œæˆï¼Œä½†æ˜¯ <font color="green">åœ¨ sysinit.target ä¸­è¿™äº›æœåŠ¡ä¸æ¨¡å—æ˜¯å¯ä»¥å¹¶è¡Œå¯åŠ¨çš„ã€‚</font></p>
<p><font color="red">For basic.target çŠ¶æ€</font></p>
<p>systemd æ¥ä¸‹æ¥å¯åŠ¨ basic.targetï¼Œå¯åŠ¨å…¶æ‰€è¦æ±‚çš„æ‰€æœ‰å•å…ƒã€‚ basic.target é€šè¿‡å¯åŠ¨ä¸‹ä¸€ç›®æ ‡æ€æ‰€éœ€çš„å•å…ƒè€Œæä¾›äº†æ›´å¤šçš„åŠŸèƒ½ï¼Œè¿™åŒ…æ‹¬å„ç§å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•è·¯å¾„ã€é€šä¿¡ socketsï¼Œä»¥åŠå®šæ—¶å™¨ç­‰ã€‚<font color="green">åœ¨ basic.target ä¸­è¿™äº›æœåŠ¡ä¸æ¨¡å—ä¹Ÿæ˜¯å¯ä»¥å¹¶è¡Œå¯åŠ¨çš„ã€‚</font></p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<p><strong>[Step 3] &gt;&gt;&gt;</strong> <font color="orange">systemd å¯åŠ¨æœ€ç»ˆ graphical.target ä¸‹çš„æœ¬æœºä¸æœåŠ¡å™¨æœåŠ¡</font></p>
<p>ç”±äºå½“å‰ default.target æŒ‡å‘ graphical.target ç›®æ ‡æ€ï¼Œé‚£ä¹ˆè¿™ä¸€æ­¥å°±å¯åŠ¨å¯¹åº”çš„ç›®æ ‡æ€ä¸‹æœåŠ¡ã€‚å®ƒçš„æœåŠ¡å­˜åœ¨äº <code>/etc/systemd/system/graphical.target.wants</code> ç›®å½•ä¸­ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ll /etc/systemd/system/graphical.target.wants/</span></span><br><span class="line">total 0</span><br><span class="line">lrwxrwxrwx. 1 root root 47 Mar  7 01:30 accounts-daemon.service -&gt; /usr/lib/systemd/system/accounts-daemon.service</span><br><span class="line">lrwxrwxrwx. 1 root root 61 Mar  7 01:31 initial-setup-reconfiguration.service -&gt; /usr/lib/systemd/system/initial-setup-reconfiguration.service</span><br><span class="line">lrwxrwxrwx. 1 root root 44 Mar  7 01:31 rtkit-daemon.service -&gt; /usr/lib/systemd/system/rtkit-daemon.service</span><br><span class="line">lrwxrwxrwx. 1 root root 39 Mar  7 01:31 udisks2.service -&gt; /usr/lib/systemd/system/udisks2.service</span><br></pre></td></tr></table></figure>

<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<p><strong>[Step 4] &gt;&gt;&gt;</strong> <font color="orange">systemd æœ€åæ‰§è¡Œ graphical.target ä¸‹çš„ /etc/rc.d/rc.local</font></p>
<p><font color="red">systemd æ˜¯å¯ä»¥å…¼å®¹ systemv init ä¸­çš„ rc.local é…ç½®çš„ï¼Œé€šè¿‡ rc-local.service æ¥å®ç°å…¼å®¹çš„ã€‚</font></p>
<p>ä½ å¯ä»¥é€šè¿‡æŸ¥çœ‹å…¶é…ç½®æ–‡ä»¶æ¥è§‚å¯Ÿå¦‚ä½•å¯åŠ¨ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> systemctl cat rc-local.service</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=/etc/rc.d/rc.local Compatibility</span><br><span class="line">ConditionFileIsExecutable=/etc/rc.d/rc.local</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/etc/rc.d/rc.local start</span><br><span class="line">TimeoutSec=0</span><br><span class="line">RemainAfterExit=yes</span><br></pre></td></tr></table></figure>

<p>systemd åœ¨å¯åŠ¨çš„å¾ˆæ—©æ—¶å€™å°±ä¼šåˆ¤æ–­ /etc/rc.local æ˜¯å¦å­˜åœ¨å¹¶ä¸”æ˜¯å¯æ‰§è¡Œçš„ï¼Ÿï¼ï¼</p>
<p>å¦‚æœæ»¡è¶³æ¡ä»¶ &gt;&gt;&gt; é‚£ä¹ˆ systemd ä¼šè°ƒç”¨ /usr/lib/systemd/system-generators/ ä¸‹é¢çš„å°ç¨‹åºæ¥æŠŠ rc-local.service æœåŠ¡åŠ å…¥åˆ° default.target ä¸­æ¥ã€‚è¿™æ ·åœ¨åé¢çš„æ‰§è¡Œæ—¶å°±ä¼šè§¦å‘ rc.local çš„è¿è¡Œã€‚</p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<p><font color="red">â†“â†“â†“â†“â†“â†“ å…¼å®¹ System V init å¯åŠ¨ â†“â†“â†“â†“â†“â†“</font></p>
<p>systemd ä¹Ÿä¼šæŸ¥çœ‹è€å¼çš„ systemV init ç›®å½•ï¼ˆ/etc/init.d/ï¼‰ä¸­æ˜¯å¦å­˜åœ¨ç›¸å…³å¯åŠ¨æ–‡ä»¶ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™ systemd æ ¹æ®è¿™äº›é…ç½®æ–‡ä»¶çš„å†…å®¹å¯åŠ¨å¯¹åº”çš„æœåŠ¡ã€‚åœ¨ Fedora ç³»ç»Ÿä¸­ï¼Œè¿‡æ—¶çš„ç½‘ç»œæœåŠ¡å°±æ˜¯é€šè¿‡è¯¥æ–¹å¼å¯åŠ¨çš„ä¸€ä¸ªå®ä¾‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ls /etc/init</span></span><br><span class="line">init.d/  inittab</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> ls /etc/init.d/</span></span><br><span class="line">functions  netconsole  network  README</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Upstart-å¯åŠ¨æµç¨‹åˆ†æ"><a href="#Upstart-å¯åŠ¨æµç¨‹åˆ†æ" class="headerlink" title="Upstart å¯åŠ¨æµç¨‹åˆ†æ"></a>Upstart å¯åŠ¨æµç¨‹åˆ†æ</h3><p>Upstart æ˜¯ä¸€ä¸ªä½¿ç”¨åŸºäºäº‹ä»¶ï¼ˆEventï¼‰çš„ System-V Init åˆå§‹åŒ–ç³»ç»Ÿçš„æ›¿ä»£å“ï¼Œæœ€åˆä¸º Ubuntu å‘è¡Œç‰ˆå¼€å‘ï¼Œä»¥é€‚åˆæ‰€æœ‰ Linux å‘è¡Œç‰ˆä¸ºç›®æ ‡ã€‚</p>
<p>è€Œ <font color="orange">Upstart è¿è¡Œçš„ç¬¬ä¸€ä¸ª init è¿›ç¨‹æ˜¯ Upstart initï¼ˆ/sbin/init splashï¼‰&lt;&lt;&lt; pid=1ï¼Œæ˜¯æ‰€æœ‰è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ã€‚</font></p>
<p>å¯¹äº Upstart è€Œè¨€ï¼Œ/etc/initï¼ˆ/etc/event.dï¼‰é…ç½®ç›®å½•æ˜¯å…³é”®ï¼Œé‡Œé¢å…¨æ˜¯ä½œä¸šé…ç½®æ–‡ä»¶ï¼ˆæ§åˆ¶ä½œä¸šçš„å¯åŠ¨/åœæ­¢ï¼‰ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ls /etc/init</span></span><br><span class="line">acpid.conf                   container-detect.conf     hwclock.sh.conf             mounted-tmp.conf                  rcS.conf             tty6.conf</span><br><span class="line">alsa-utils.conf              control-alt-delete.conf   irqbalance.conf             mounted-var.conf                  rc-sysinit.conf      udev.conf</span><br><span class="line">anacron.conf                 cron.conf                 kmod.conf                   mountkernfs.sh.conf               resolvconf.conf      udevmonitor.conf</span><br><span class="line">apparmor.conf                cups-browsed.conf         lightdm.conf                mountnfs-bootclean.sh.conf        rfkill-restore.conf  udevtrigger.conf</span><br><span class="line">apport.conf                  cups.conf                 mountall-bootclean.sh.conf  mountnfs.sh.conf                  rfkill-store.conf    ufw.conf</span><br><span class="line">avahi-cups-reload.conf       dbus.conf                 mountall.conf               mtab.sh.conf                      rsyslog.conf         upstart-file-bridge.conf</span><br><span class="line">avahi-daemon.conf            failsafe.conf             mountall-net.conf           networking.conf                   setvtrgb.conf        upstart-socket-bridge.conf</span><br><span class="line">bluetooth.conf               failsafe-x.conf           mountall-reboot.conf        network-interface.conf            shutdown.conf        upstart-udev-bridge.conf</span><br><span class="line">bootmisc.sh.conf             flush-early-job-log.conf  mountall.sh.conf            network-interface-container.conf  ssh.conf             ureadahead.conf</span><br><span class="line">checkfs.sh.conf              friendly-recovery.conf    mountall-shell.conf         network-interface-security.conf   thermald.conf        ureadahead-other.conf</span><br><span class="line">checkroot-bootclean.sh.conf  gpu-manager.conf          mountdevsubfs.sh.conf       network-manager.conf              tty1.conf            usb-modeswitch-upstart.conf</span><br><span class="line">checkroot.sh.conf            hostname.conf             mounted-debugfs.conf        passwd.conf                       tty2.conf            wait-for-state.conf</span><br><span class="line">console.conf                 hostname.sh.conf          mounted-dev.conf            procps.conf                       tty3.conf            whoopsie.conf</span><br><span class="line">console-font.conf            hwclock.conf              mounted-proc.conf           procps-instance.conf              tty4.conf</span><br><span class="line">console-setup.conf           hwclock-save.conf         mounted-run.conf            rc.conf                           tty5.conf</span><br></pre></td></tr></table></figure>

<p>Ubuntu Upstart ä¸ºäº†å…¼å®¹åŸ System V Init æ–¹å¼çš„æœåŠ¡ï¼Œå…¶å¯åŠ¨å¤§æ¦‚æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://s2.loli.net/2024/03/16/wHfOAuM2CvDl5cy.png"></p>
<p>| ================================================== <strong>Split Line</strong> =============================================== |</p>
<p>ä¸‹é¢é€æ­¥å‰–æè¯´æ˜ Upstart å¯åŠ¨çš„å…³é”®æ­¥éª¤ï¼š</p>
<p><strong>[1] &gt;&gt;&gt;</strong> è®¾å¤‡ä¸Šç”µåï¼Œç”± Grub åŠ è½½å†…æ ¸ Kernelï¼Œå†…æ ¸åœ¨å®Œæˆåˆå§‹åŒ–åä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªè¿›ç¨‹ init è¿›ç¨‹ &lt;&lt;&lt; Upstart initï¼›</p>
<p><strong>[2] &gt;&gt;&gt;</strong> Upstart init åœ¨è¿›è¡Œè‡ªèº«çš„ä¸€äº›åˆå§‹åŒ–ä¹‹åï¼Œä¼šå‘å‡º startup äº‹ä»¶ï¼›</p>
<p><strong>[3] &gt;&gt;&gt;</strong> startup äº‹ä»¶ä¼šè§¦å‘ mountall ç­‰ä½œä¸šï¼ˆ/etc/init ä¸‹çš„ä½œä¸šé…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å« start on startup è¯­å¥)ï¼›</p>
<p><strong>[4] &gt;&gt;&gt;</strong> mountall ä½œä¸šä¸­ä¼šå‘å°„ï¼ˆemitsï¼‰ï¼švirtual-filesystems &amp; local-filesystems &amp; remote-filesystems &amp; all-swaps &amp; filesystem &amp; mounting &amp; mounted äº‹ä»¶ï¼›</p>
<p><strong>[5] &gt;&gt;&gt;</strong> å…¶ä¸­ï¼Œmounted äº‹ä»¶ä¼šè§¦å‘ container-detect ä½œä¸šï¼Œä»è€Œå‘å‡º container äº‹ä»¶å»è§¦å‘ network-interface-container ä½œä¸šï¼Œå…¶åˆå‘å‡º net-device-added äº‹ä»¶å»è§¦å‘ network-interface ä½œä¸šï¼Œè¿›è€Œå‘å‡º static-network-up äº‹ä»¶ï¼Œstatic-network-up äº‹ä»¶å’Œ filesystem äº‹ä»¶ä¸€èµ·å»è§¦å‘ rc-sysinit ä½œä¸šï¼›rc-sysinit æœ€åä¼šè°ƒç”¨ telinit â€œ$[DEFAULT_RUNLEVEL]â€ å»æ”¹å˜è¿è¡Œç­‰çº§ï¼Œä»è€Œå‘å‡º runlevel äº‹ä»¶è§¦å‘ rc ä½œä¸šï¼›</p>
<p><strong>[6] &gt;&gt;&gt;</strong> åœ¨ /etc/init/rc.conf ä¸­ä¼šè°ƒç”¨ /etc/init.d/rc $RUNLEVELï¼Œåˆ°è¿™é‡Œå°±å’Œ System V Initï¼ˆ/etc/init/rcS.confï¼‰ç±»ä¼¼äº†~~~</p>
<p><strong>[7] &gt;&gt;&gt;</strong> ä¼šå» /etc/rcN.d ç›®å½•ä¸‹æ‰§è¡Œæ‰€æœ‰è„šæœ¬ï¼Œä»¥å¯åŠ¨ç›¸åº”è¿è¡Œç­‰çº§çš„ç³»ç»ŸæœåŠ¡ã€‚</p>
<hr>
</div><div class="article-licensing box"><div class="licensing-title"><p>ä¸€æ–‡è§£æ Linux æ“ä½œç³»ç»Ÿå¼•å¯¼å¯åŠ¨å…¨æµç¨‹</p><p><a href="https://www.orangeshare.cn/2015/01/26/yi-wen-jie-xi-linux-cao-zuo-xi-tong-yin-dao-qi-dong-quan-liu-cheng/">https://www.orangeshare.cn/2015/01/26/yi-wen-jie-xi-linux-cao-zuo-xi-tong-yin-dao-qi-dong-quan-liu-cheng/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Waldeinsamkeit</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2015-01-26</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-03-16</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Operate-System/">Operate System</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2015/01/27/linux-installation-tutorial/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Linux Installation tutorial</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2015/01/25/a-quick-guide-to-linux-servers/"><span class="level-item">A Quick Guide To Linux Servers</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen  order-3 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Waldeinsamkeit"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Waldeinsamkeit</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">118</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">13</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">43</p></a></div></div></nav></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Linux-OS-å¼•å¯¼å¯åŠ¨æµç¨‹"><span class="level-left"><span class="level-item">1</span><span class="level-item">Linux OS å¼•å¯¼å¯åŠ¨æµç¨‹</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#BIOS"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">BIOS</span></span></a></li><li><a class="level is-mobile" href="#MBR"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">MBR</span></span></a></li><li><a class="level is-mobile" href="#GRUB1-GRUB2"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">GRUB1/GRUB2</span></span></a></li><li><a class="level is-mobile" href="#Kernel"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">Kernel</span></span></a></li><li><a class="level is-mobile" href="#Init"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">Init</span></span></a></li><li><a class="level is-mobile" href="#RunLevel"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">RunLevel</span></span></a></li><li><a class="level is-mobile" href="#Login-In"><span class="level-left"><span class="level-item">1.7</span><span class="level-item">Login In</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Reff-Reading"><span class="level-left"><span class="level-item">2</span><span class="level-item">Reff Reading</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#å…³äº-GRUB1-GRUB2"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">å…³äº GRUB1/GRUB2</span></span></a></li><li><a class="level is-mobile" href="#Systemd-å¯åŠ¨æµç¨‹åˆ†æ"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Systemd å¯åŠ¨æµç¨‹åˆ†æ</span></span></a></li><li><a class="level is-mobile" href="#Upstart-å¯åŠ¨æµç¨‹åˆ†æ"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Upstart å¯åŠ¨æµç¨‹åˆ†æ</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="When Art Meets Tech" height="28"></a><p class="is-size-7"><span>&copy; 2024 Waldeinsamkeit</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>