<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Git 使用指南之时光穿梭机 - When Art Meets Tech</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="When Art Meets Tech"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="When Art Meets Tech"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="上一篇博文你已经了解了 Git 版本控制系统的基本概念，不同平台下 Git 的安装以及相关配置，以及 Git 版本库初识。并且在上一篇博文中我们已经成功地演示了如何使用 Git 管理一个既存项目（GitTestProject），下面我们将基于这个版本库为实例继续来看 Git 版本库日常管理的常规操作。 叮咚~~，完成当前博文学习，即可达成 “初步项目版本管理” 成就！！！"><meta property="og:type" content="blog"><meta property="og:title" content="Git 使用指南之时光穿梭机"><meta property="og:url" content="https://www.orangeshare.cn/2017/07/02/git-shi-yong-zhi-nan-zhi-shi-guang-chuan-suo-ji/"><meta property="og:site_name" content="When Art Meets Tech"><meta property="og:description" content="上一篇博文你已经了解了 Git 版本控制系统的基本概念，不同平台下 Git 的安装以及相关配置，以及 Git 版本库初识。并且在上一篇博文中我们已经成功地演示了如何使用 Git 管理一个既存项目（GitTestProject），下面我们将基于这个版本库为实例继续来看 Git 版本库日常管理的常规操作。 叮咚~~，完成当前博文学习，即可达成 “初步项目版本管理” 成就！！！"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/cmd_git_time_line.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_head_current.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_head_backaddr.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_vers_control_principle.jpg"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_eveayArea_priciple_exp.png"><meta property="article:published_time" content="2017-07-02T07:18:00.000Z"><meta property="article:modified_time" content="2022-03-05T06:48:23.085Z"><meta property="article:author" content="Waldeinsamkeit"><meta property="article:tag" content="Git"><meta property="article:tag" content="Github"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/cmd_git_time_line.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.orangeshare.cn/2017/07/02/git-shi-yong-zhi-nan-zhi-shi-guang-chuan-suo-ji/"},"headline":"When Art Meets Tech","image":["https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/cmd_git_time_line.png","https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_head_current.png","https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_head_backaddr.png","https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_vers_control_principle.jpg","https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_eveayArea_priciple_exp.png"],"datePublished":"2017-07-02T07:18:00.000Z","dateModified":"2022-03-05T06:48:23.085Z","author":{"@type":"Person","name":"Waldeinsamkeit"},"description":"上一篇博文你已经了解了 Git 版本控制系统的基本概念，不同平台下 Git 的安装以及相关配置，以及 Git 版本库初识。并且在上一篇博文中我们已经成功地演示了如何使用 Git 管理一个既存项目（GitTestProject），下面我们将基于这个版本库为实例继续来看 Git 版本库日常管理的常规操作。 叮咚~~，完成当前博文学习，即可达成 “初步项目版本管理” 成就！！！"}</script><link rel="canonical" href="https://www.orangeshare.cn/2017/07/02/git-shi-yong-zhi-nan-zhi-shi-guang-chuan-suo-ji/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.2.0"></head>    <body class="is-3-column">    <nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="When Art Meets Tech" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Hexo Search" href="https://hexo.io/zh-cn/"><i class="fab fa-hotjar"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><i class="fas fa-angle-double-right"></i>Git 使用指南之时光穿梭机</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="${date_xml(page.date)}" title="${date_xml(page.date)}">2017-07-02</time></span><span class="level-item is-hidden-mobile"><i class="far fa-calendar-check"> </i><time dateTime="${date_xml(page.updated)}" title="${date_xml(page.updated)}">2022-03-05</time></span><span class="level-item"><a class="link-muted" href="/categories/Git/">Git</a></span><span class="level-item">an hour read (About 9529 words)</span></div></div><div class="content"><p>上一篇博文你已经了解了 Git 版本控制系统的基本概念，不同平台下 Git 的安装以及相关配置，以及 Git 版本库初识。并且在上一篇博文中我们已经成功地演示了如何使用 Git 管理一个既存项目（GitTestProject），下面我们将基于这个版本库为实例继续来看 <strong>Git 版本库日常管理的常规操作</strong>。</p>
<p>叮咚~~，完成当前博文学习，即可达成 “初步项目版本管理” 成就！！！</p>
<a id="more"></a>

<blockquote>
<p><strong>版权说明：</strong> 本文思路以及内容主要来自廖雪峰老师的 <a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000">Git 教程</a> （强烈推荐膜拜原文），并结合个人使用所作，只作为学习记录使用。如内容有侵权请联系删除，禁止转载！</p>
</blockquote>
<p>更多 Git 相关内容，请关注博主 Git 博文系列：</p>
<p><a href="https://www.orangeshare.cn/2017/07/01/git-shi-yong-zhi-nan-zhi-chu-shi/">之一 &gt;&gt;&gt; Git 使用指南之初识</a></p>
<p><a href="https://www.orangeshare.cn/2017/07/02/git-shi-yong-zhi-nan-zhi-shi-guang-chuan-suo-ji/">之二 &gt;&gt;&gt; Git 使用指南之时光穿梭机</a></p>
<p><a href="https://www.orangeshare.cn/2017/07/03/git-shi-yong-zhi-nan-zhi-yuan-cheng-cang-ku/">之三 &gt;&gt;&gt; Git 使用指南之远程仓库</a></p>
<p><a href="https://www.orangeshare.cn/2017/07/04/git-shi-yong-zhi-nan-zhi-fen-zhi-guan-li/">之四 &gt;&gt;&gt; Git 使用指南之分支管理</a></p>
<p><a href="https://www.orangeshare.cn/2017/07/05/git-shi-yong-zhi-nan-zhi-workflow-gong-zuo-liu/">之五 &gt;&gt;&gt; Git 使用指南之 WorkFlow (工作流)</a></p>
<p><a href="https://www.orangeshare.cn/2017/07/05/git-shi-yong-zhi-nan-zhi-git-zi-ding-yi/">之六 &gt;&gt;&gt; Git 使用指南之 Git 自定义</a></p>
<p><a href="https://www.orangeshare.cn/2017/07/06/git-shi-yong-zhi-nan-zhi-head-zhi-zhen/">之七 &gt;&gt;&gt; Git 使用指南之 HEAD 指针</a></p>
<p><a href="https://www.orangeshare.cn/2017/07/07/git-shi-yong-zhi-nan-zhi-git-zhong-de-hei-mo-fa/">之八 &gt;&gt;&gt; Git 使用指南之 Git 中的黑魔法</a></p>
<p>| &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p>
<p>上篇博文中 <strong>GitTestProject 版本库目录结构说明：</strong></p>
<p>GitTestProject 版本库包含：Server 目录、Client 目录、以及 readme.txt 说明文档。</p>
<p>Server 目录下包含一个名为：service.py 的文件，其内容为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This is a Test!</span></span><br></pre></td></tr></table></figure>

<p>Client 目录视作是一个仅包含 Git 占位文件（.gitignore）的空目录。</p>
<p>readme.txt 文件内容为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Git is a version control system.</span><br><span class="line">Git is free software.</span><br></pre></td></tr></table></figure>

<p>==============================================================|</p>
<hr>
<p>下面一起来看 Git 到底有多神奇：</p>
<h2 id="File-Modification-In-Repo"><a href="#File-Modification-In-Repo" class="headerlink" title="File Modification In Repo"></a>File Modification In Repo</h2><p>来看版本库中的文件修改 &gt;&gt;&gt;</p>
<p>我们知道，Server 目录下包含一个名为：service.py 的文件，其内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This is a Test!</span></span><br></pre></td></tr></table></figure>

<p>到了工作时间，我们想要接着继续写 service.py 脚本了，我做了如下变更：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Git is a distributed version control system.</span></span><br><span class="line"><span class="comment"># Git is free software.</span></span><br><span class="line"><span class="comment"># This is a Test!</span></span><br></pre></td></tr></table></figure>

<hr>
<p>通过上一篇博文知道，文件修改完成之后，想要 GitTestProject 版本库管理，还需要执行：添加（git add）&amp;&amp; 提交（git commit）的操作。</p>
<p><strong>CMD 1 –&gt;&gt;&gt; git status</strong></p>
<p>事实上，在添加、提交变更之前，我们需要关注的是：Git 版本库（GitTestProject）是否已经实时地跟踪到了我们的修改（很慌，要是没有识别到修改怎么办？），这是很重要的！！！当然是可以的，毕竟 Git 就是干这个的。</p>
<p><strong><code>git status</code></strong> 命令说明： 可以让我们 <strong>时刻监控到版本仓库中所有管理文件的当前状态</strong>，我们在 Git Bash 中运行查看一下 Git<br>监控信息：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">        modified:   Server/service.py</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br></pre></td></tr></table></figure>

<p>可以看到，Git 告诉我们 <code>modified:   Server/service.py</code>（service.py 已经被修改），并且提醒我们 <code>Changes not staged for commit</code>（变更未提交）。</p>
<p>一般，一个文件的状态通常可以分为：</p>
<ul>
<li>不受版本控制的 untracked 状态</li>
<li>受版本控制并且已修改的 modified 状态</li>
<li>受版本控制已修改并提交到暂存区的 staged 状态</li>
<li>从暂存区已经提交到本地仓库的 committed 状态</li>
<li>提交到本地仓库未修改或者从远程仓库克隆下来的 unmodified 状态</li>
</ul>
<hr>
<p><strong>CMD 2 –&gt;&gt;&gt; git diff</strong></p>
<p>上面我们知道，版本库确实检测到了 <code>service.py</code> 文件被变更了！但我们更加关注的是版本库检测到的 service.py 文件的修改，和我们手动修改是否一致？！！这时需要使用 <code>git diff（git different）</code> 命令来查看修改后文件和修改前文件的差异：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git diff Server/service.py</span></span><br><span class="line">diff --git a/Server/service.py b/Server/service.py</span><br><span class="line">index 68f5fe0..433af3b 100644</span><br><span class="line">--- a/Server/service.py</span><br><span class="line">+++ b/Server/service.py</span><br><span class="line">@@ -1 +1,3 @@</span><br><span class="line">-This is a Test!</span><br><span class="line">+# Git is a distributed version control system.</span><br><span class="line">+# Git is free software.</span><br><span class="line">+# This is a Test!</span><br></pre></td></tr></table></figure>

<p>可以看到 Git 已经跟踪了我们对 service.py 文件的修改，这下舒服了~，将其提交给版本库也就放心了。</p>
<hr>
<p><strong>CMD 3 –&gt;&gt;&gt; git add &amp;&amp; git commit -m</strong></p>
<p>提交~提交 &gt;&gt;&gt;</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 添加变更至暂存区（见下文 Git Stage 说明），等待 commit</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git add Server/service.py</span></span><br></pre></td></tr></table></figure>

<p>执行后同样没有任何输出（成功信号）。在执行 <code>git commit</code> 之前，我们再次运行 <code>git status</code> 查看一下当前仓库的状态（不放心再确认一下）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="line"></span><br><span class="line">        modified:   Server/service.py</span><br></pre></td></tr></table></figure>

<p>Git 告诉我们将要被提交的修改是：Server/service.py（心里默念一句 NB），确定之后我们直接提交给版本库：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&#x27;Add help info&#x27;</span></span></span><br><span class="line">[master 8622ab2] Add help info</span><br><span class="line"> 1 file changed, 3 insertions(+), 1 deletion(-)</span><br></pre></td></tr></table></figure>

<p>提交完成后，我们再次查看版本库状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure>

<p>Git 监控信息显示：当前没有需要提交的变更，并且工作目录是干净（working tree clean）的，完美~</p>
<hr>
<h2 id="Time-Shuttle"><a href="#Time-Shuttle" class="headerlink" title="Time Shuttle"></a>Time Shuttle</h2><p>Git 实现时光穿梭（版本回滚） &gt;&gt;&gt;</p>
<p>上述版本库中文件的修改操作，再练习一次，修改 service.py 文件如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Git is a distributed version control system.</span></span><br><span class="line"><span class="comment"># Git is free software.</span></span><br><span class="line"><span class="comment"># This is a Test!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;Git is very useful!!!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>然后尝试添加 &amp;&amp; 提交：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git add Server/service.py</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&#x27;Add test code&#x27;</span></span></span><br><span class="line">[master dd32d2d] Add test code</span><br><span class="line"> 1 file changed, 2 insertions(+)</span><br></pre></td></tr></table></figure>

<p>像这样，不断对文件进行修改，然后不断提交变更到版本库里。这就好像游戏存档一样：打通一部分关卡，存档一次，形成不同的存档库。一旦失败的话，可以通过存档回滚到最新的存档。</p>
<p>Git 也是一样，每当你觉得文件修改到一定程度（完成某项功能，或某个版本）的时候，就可以 “保存一个快照”，这个快照在 Git 中被称为一次 <code>commit</code>。一旦你把文件改乱了，或者误删了文件，还可以从最近的一个 <code>commit</code> 恢复（版本回滚），然后继续工作，而不是把几个月的工作成果全部丢失。</p>
<hr>
<h3 id="变更历史记录"><a href="#变更历史记录" class="headerlink" title="变更历史记录"></a>变更历史记录</h3><p>在开始讲解 Git 版本库的回滚操作之前，我们先来回顾一下 <code>service.py</code> 一共有多少个 <strong>commit</strong>（版本、快照）被提交到 Git 仓库里：</p>
<blockquote>
<p>明确了有多少、有哪些版本，才可以准确地在版本库中的不同版本间进行回滚</p>
</blockquote>
<p>版本 1：ADD Project Base</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># service.py 被提交到 GitTestProject，内容如下：</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This is a Test!</span></span><br></pre></td></tr></table></figure>

<p>版本 2：Add help info</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Git is a distributed version control system.</span></span><br><span class="line"><span class="comment"># Git is free software.</span></span><br><span class="line"><span class="comment"># This is a Test!</span></span><br></pre></td></tr></table></figure>

<p>版本 3：ADD test code</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Git is a distributed version control system.</span></span><br><span class="line"><span class="comment"># Git is free software.</span></span><br><span class="line"><span class="comment"># This is a Test!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;Git is very useful!!!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>截至目前为止，当前版本库中，我们执行过 3 次 <code>commit</code> 操作，形成了三个不同的版本。</p>
<ul>
<li>版本 1：ADD Project Base</li>
<li>版本 2：Add help info</li>
<li>版本 3：ADD test code</li>
</ul>
<p>以上列出的就是当前版本库中的项目的 <strong>变更历史记录</strong>。</p>
<hr>
<p><strong>CMD 4 –&gt;&gt;&gt; git log</strong></p>
<p>然后，实际工作中，我们怎么可能记得一个几千行的文件变更了多少次、每次都改了什么内容（不然要版本控制系统干什么，和原始版本控制有何区别？），所以需要版本控制系统可以告诉我们 <strong>项目的变更历史记录</strong>。</p>
<p><code>git log</code> 命令就是做这个事的，它会显示出版本库中：<strong>从最新到最远的提交日志</strong>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span></span></span><br><span class="line">commit 47f21abe1449214864c84c2abdf44168ee26df60 (HEAD -&gt; master)</span><br><span class="line">Author: staff_ming &lt;staff_ming@xxxx.com&gt;</span><br><span class="line">Date:   Fri Dec 21 11:20:04 2018 +0800</span><br><span class="line"></span><br><span class="line">    Add test code</span><br><span class="line"></span><br><span class="line">commit 277b8bf5e9d974f73f1ace2dcd20fea2afd0296a</span><br><span class="line">Author: staff_ming &lt;staff_ming@xxxx.com&gt;</span><br><span class="line">Date:   Fri Dec 21 11:02:34 2018 +0800</span><br><span class="line"></span><br><span class="line">    Add help info</span><br><span class="line"></span><br><span class="line">commit 6a8c6bab3053e25a64241a22a56083c549bf79f2</span><br><span class="line">Author: staff_ming &lt;staff_ming@xxxx.com&gt;</span><br><span class="line">Date:   Thu Dec 20 19:53:06 2018 +0800</span><br><span class="line"></span><br><span class="line">    ADD Project Base</span><br></pre></td></tr></table></figure>

<p>如果嫌输出信息太多，看得眼花缭乱的，可以试试加上 <code>--pretty=oneline</code> 参数（清晰了很多）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> --pretty=oneline</span></span><br><span class="line">47f21abe1449214864c84c2abdf44168ee26df60 (HEAD -&gt; master) ADD test code</span><br><span class="line">277b8bf5e9d974f73f1ace2dcd20fea2afd0296a Add help info</span><br><span class="line">6a8c6bab3053e25a64241a22a56083c549bf79f2 ADD Project Base</span><br></pre></td></tr></table></figure>

<p>当然你也可以 <strong>查看单个文件的提交日志：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">log</span> Server/service.py</span></span><br></pre></td></tr></table></figure>

<p>| &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; <strong>历史变更记录解析</strong> &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</p>
<p>你看到的一大串类似 <code>47f21ab...</code> 的是 <code>commit id</code>（版本号），和 SVN 不一样，Git 的 commit id 不是 1，2，3…… 递增的数字，而是一个非常大的数字（十六进制）。</p>
<p>为什么采用这种机制（SHA-1）？因为 Git 是分布式的版本控制系统，后面我们还要研究多人在同一个版本库里工作，如果大家都用 1，2，3…… 作为版本号，很容易就冲突了。</p>
<p>每提交一个新版本，实际上 Git 就会把它们自动串成一条时间线。如果使用可视化工具（Git GUI）查看 Git 历史，就可以更清楚地看到提交历史的时间线：</p>
<p><img src="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/cmd_git_time_line.png"></p>
<p>================================================================|</p>
<p>有了版本库时间线（变更历史记录线），接下来就可以启动时光穿梭机进行版本回滚了…</p>
<p>问题：假设 <code>版本 3：ADD test code</code> 有错误，我们想要将版本库回滚到上一个版本（版本 2：Add help info），怎么办？？！</p>
<hr>
<p><strong>HEAD</strong></p>
<p>开始回滚前，需要简单介绍一下 <code>HEAD</code> 的基本概念：</p>
<p>我们知道，要想实现版本回滚，Git 必须被指定要回滚到哪个版本。在 Git 中，<strong>用 HEAD 关键字表示当前版本</strong>，也就是最新的提交 <code>47f21ab...</code>（commit id）。上一个版本表示为：HEAD^，上上一个版本可以表示为:HEAD^^，很多人就要问了那如果要表示往上 90 个版本呢，难道要写 90 个 ^，当然不可能！版本数目较多时可以表示为：HEAD~90。</p>
<hr>
<h3 id="时空穿梭"><a href="#时空穿梭" class="headerlink" title="时空穿梭"></a>时空穿梭</h3><p>有了以上的知识储备我们就可以进行版本库的 <strong>时光穿梭</strong> 了 &gt;&gt;&gt;</p>
<p><strong>CMD 5 –&gt;&gt;&gt; git reset –hard</strong></p>
<p>Git 版本库中的 “时光穿梭” 使用 <code>git reset（版本库重置）</code> 命令来实现其功能。</p>
<p><strong>1 –&gt; 回到过去</strong></p>
<p>现在我们来看如何从当前版本【 Add test code 】回滚到上一版本【 Add help info 】，即：Add test code -&gt;&gt;&gt; Add help info，指令如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git reset --hard HEAD^</span></span><br><span class="line">HEAD is now at 8622ab2 Add help info</span><br></pre></td></tr></table></figure>

<p>这里我们侧重看 <code>git reset</code> 实现功能，参数 <code>--hard</code> 会在后续补充说明，这里你只需知道它是版本指定相关参数即可。回滚后，我们来看 service.py 当前版本内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat Server&#x2F;service.py</span><br><span class="line"># Git is a distributed version control system.</span><br><span class="line"># Git is free software.</span><br><span class="line"># This is a Test!</span><br></pre></td></tr></table></figure>

<p>我们发现，果然 service.py 时空倒流到上一个版本了。</p>
<hr>
<p><strong>2 –&gt; 穿梭到未来</strong></p>
<p>如果你现在想重新回滚到 –&gt;&gt; 版本3：ADD test code 怎么办？</p>
<p>此时，我们查看一下当前版本库的提交日志信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git log --pretty&#x3D;oneline</span><br><span class="line">277b8bf5e9d974f73f1ace2dcd20fea2afd0296a (HEAD -&gt; master) Add help info</span><br><span class="line">6a8c6bab3053e25a64241a22a56083c549bf79f2 ADD Project Base</span><br></pre></td></tr></table></figure>

<p>可以发现，之前最新的那个版本 【 ADD test code 】 已经看不到了！就好比你从现在回到了过去，但你又想回到现在（未来），你想通过 <code>git log</code> 察看现在时间节点在时间线上的版本标识，结果发现你已经找不到了。难道只能活在过去了么？</p>
<p>在给出办法之前你先祈祷吧…之前我们一直使用的 Git Bash 窗口你还没手贱关掉。我们可以找到先前 【 ADD test code 】 的 <code>commit id</code> 是 <code>47f21abe....</code>，这样又找到了回去的时间节点版本标识（确实关闭也不要紧，是不是有点慌，哈哈。2333），下一小节【HEAD &amp;&amp; Commit Id】中我们会给出 <code>commit id</code> 的查询方法）。如果你已经关闭，可以转至下一小节查询一下~</p>
<blockquote>
<p><strong>commit id</strong> 也可以作为 Git 版本库中时间线上的版本标识，在 Git 项目管理中这要比使用 HEAD 更加合理。</p>
</blockquote>
<p>重新回滚到 –&gt;&gt; 版本3：Add test code 的指令如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git reset --hard 47f21abe</span></span><br><span class="line">HEAD is now at 47f21abe ADD test code</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：版本号（commit id）没必要写全，Git 会去自动检索的，当然也不能太少，否则可能无法和其它版本区别。</p>
</blockquote>
<p>此时查看 service.py，发现我们已经回到了“未来”：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat Server/service.py</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git is a distributed version control system.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git is free software.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is a Test!</span></span><br><span class="line"></span><br><span class="line">print (&#x27;Git is very useful!!!&#x27;)</span><br></pre></td></tr></table></figure>

<p>重新查看版本库变更历史记录如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git log --pretty=oneline</span><br><span class="line">47f21abe1449214864c84c2abdf44168ee26df60 (HEAD -&gt; master) ADD test code</span><br><span class="line">277b8bf5e9d974f73f1ace2dcd20fea2afd0296a Add help info</span><br><span class="line">6a8c6bab3053e25a64241a22a56083c549bf79f2 ADD Project Base</span><br></pre></td></tr></table></figure>

<p>至此，你就可以自由地进行版本库的回滚了~</p>
<hr>
<h3 id="HEAD-amp-amp-Commit-Id"><a href="#HEAD-amp-amp-Commit-Id" class="headerlink" title="HEAD &amp;&amp; Commit Id"></a>HEAD &amp;&amp; Commit Id</h3><p>区别于 SVN，在进行版本回滚的时候我们发现 Git 的版本回退速度非常快，这是由于 Git 内部的指针机制决定的。</p>
<p>Git 内部有个指向当前版本的指针，就是我们前面说的 <code>Head</code>。当你回滚版本的时候，Git 仅仅是把 HEAD 从指向 【 ADD test code 】 版本的地址：</p>
<p><img src="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_head_current.png"></p>
<p>移动指向 【 Add help info 】：</p>
<p><img src="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_head_backaddr.png"></p>
<p>然后顺便把工作区的文件更新了。所以你让 <code>HEAD</code> 指向哪个版本号，你就把当前版本定位在哪（讲到这里很多人会想到程序设计语言中的指针）。</p>
<blockquote>
<p>HEAD 所指向的版本地址就是： <code>commit id</code>。故版本库回滚时可以同时使用 <code>HEAD</code> &amp;&amp; <code>commit id</code> 作为版本标识。</p>
</blockquote>
<p><strong>CMD 6 –&gt;&gt;&gt; git reflog</strong></p>
<p>“穿越到未来” 中找不到 commit id 的问题解决方法 &gt;&gt;&gt;</p>
<p>前面我们在 <strong>穿越到未来</strong> 中提到 Git Bash 关掉后，表面看起来找不到最新版本的 <code>commit id</code>。实际上，Git 提供了指令 <code>git reflog</code> 用来记录你的每一次引用日志（HEAD 指针移动记录）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git reflog</span></span><br><span class="line">47f21ab (HEAD -&gt; master) HEAD@&#123;0&#125;: reset: moving to 47f21abe14492</span><br><span class="line">277b8bf HEAD@&#123;1&#125;: reset: moving to HEAD^</span><br><span class="line">47f21ab (HEAD -&gt; master) HEAD@&#123;2&#125;: commit: ADD test code</span><br><span class="line">277b8bf HEAD@&#123;3&#125;: commit: Add help info</span><br><span class="line">6a8c6ba HEAD@&#123;4&#125;: commit (initial): ADD Project Base</span><br></pre></td></tr></table></figure>

<p>从日志输出可以看出：Add test code 的 commit id 是 <code>47f21ab</code>。</p>
<hr>
<h2 id="Git-Stage"><a href="#Git-Stage" class="headerlink" title="Git Stage"></a>Git Stage</h2><p>Git 和其他版本控制系统（如：SVN）的一个很大的不同之处就是有 <strong>暂存区（stage）</strong> 的概念。</p>
<p>这一小节，我们将从 Git 的本地数据管理入手，深入了解 Git 中引入的暂存区（Stage）的作用。</p>
<h3 id="Git-Local-Data-Management"><a href="#Git-Local-Data-Management" class="headerlink" title="Git Local Data Management"></a>Git Local Data Management</h3><p>Git 本地数据管理，大概可以分为三个区：工作区（Working Directory）、暂存区（Stage）、以及版本库（Repository）。</p>
<h4 id="Working-Directory"><a href="#Working-Directory" class="headerlink" title="Working Directory"></a>Working Directory</h4><p>我们将当前程序开发所在目录称为：<strong>工作区（Working Directory）</strong>，也就是我们的项目开发目录（如：GitTestProject）。该区域的文件会有状态的变化且状态由 Git 自动检测，如果程序中文件做任何操作（增、删、改），文件状态均会被检测到（类似于 SVN）。</p>
<h4 id="Repository"><a href="#Repository" class="headerlink" title="Repository"></a>Repository</h4><p>工作区（GitTestProject）有一个隐藏目录 <code>.git</code> ，这个不算工作区，而是 Git 的 <strong>版本库（Repository）</strong>。</p>
<p>Git 的版本库里存储了很多东西，其中最重要的就是称为 stage（或者叫：index）的 <strong>暂存区</strong>；还有 Git 为我们自动创建第一个分支 <code>master</code>，以及指向 master 的一个指针叫 <code>HEAD</code>（分支的概念后续会有专门的博文进行讲解，这里将其理解为版本库中的一条时间线）。</p>
<h4 id="Stage"><a href="#Stage" class="headerlink" title="Stage"></a>Stage</h4><p>数据暂时存放的区域，可在工作区和版本库之间进行数据的友好交流。</p>
<hr>
<h4 id="Git-版本控制原理"><a href="#Git-版本控制原理" class="headerlink" title="Git 版本控制原理"></a>Git 版本控制原理</h4><p>当工作区检测到有文件发生变化时，那么意味着：我们在上一个版本之后再次对项目进行了变更。变更完成之后，我们可以将当前变更当做下一版本进行提交（生成一个新的版本或快照），那么就是执行 <code>git add .</code> 将所有文件提交到暂存区（stage），然后再执行 <code>git commit -m &#39;another version&#39;</code> 提交到版本库的当前分支。原理图如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_vers_control_principle.jpg"></p>
<p><strong>简单理解为：首先将需要提交的文件修改通通放到暂存区，然后一次性提交暂存区的所有修改即可。</strong></p>
<p>下面我们完成一个实例来深入了解 Git 版本控制原理，详细过程如下所示：</p>
<p>1 -&gt;&gt; 在工作区修改文件 Server/service.py 内容为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Git is a distributed version control system.</span></span><br><span class="line"><span class="comment"># Git is free software.</span></span><br><span class="line"><span class="comment"># This is a Test!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;Git is very useful!!!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Git has a mutable index called stage.</span></span><br><span class="line"><span class="comment"># Git tracks changes.</span></span><br></pre></td></tr></table></figure>

<p>2 -&gt;&gt; 在工作区添加文件 Client/request.py（内容随意），然后查看版本库当前状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Server/service.py</span><br><span class="line"></span><br><span class="line">Untracked files:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br><span class="line">        Client/request.py</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br></pre></td></tr></table></figure>

<p>Git 非常清楚地告诉我们，Server/service.py 脚本被修改了，而 Client/request.py 还从来没有被添加过，所以它的状态是 Untracked。</p>
<p>3）<code>git add .</code> 将所有修改文件提交到暂存区（stage），然后查看此时版本库状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="line"></span><br><span class="line">        new file:   Client/request.py</span><br><span class="line">        modified:   Server/service.py</span><br></pre></td></tr></table></figure>

<p>4）<code>git commit</code> 一次性把暂存区的所有修改提交到分支。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&#x27;understand how stage works&#x27;</span></span></span><br><span class="line">[master 847e6ef] understand how stage works</span><br><span class="line"> 2 files changed, 3 insertions(+)</span><br><span class="line"> create mode 100644 Client/request.py</span><br></pre></td></tr></table></figure>

<p>5）提交后，如果工作区没有做任何修改，那么工作区就是 “干净” 的：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure>

<p>此时版本库的暂存区（stage）内容会被提交的 <code>master</code> 分支。</p>
<blockquote>
<p>看到这里，肯定会有很多看客老爷们会问：<strong>为啥要暂存区，通过工作区直接提交到本地仓库不就OK了？暂存区存在有什么作用？</strong> 下文会给出说明：</p>
</blockquote>
<hr>
<h3 id="Data-Flow-In-Git"><a href="#Data-Flow-In-Git" class="headerlink" title="Data Flow In Git"></a>Data Flow In Git</h3><p>根据上文 ，我们给出当开发者通过 git 变更数据时，各区之间可能的数据传递流程示意图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/TheNightIsYoung/HexoImageBed0/Img/git_eveayArea_priciple_exp.png"></p>
<p>我们可以通过对比三个区之间的数据差别，来验证以上流程的正确性，这可以借助之前学过的  <code>git diff</code> 命令来实现：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>git diff</td>
<td>工作区 vs 暂存区</td>
</tr>
<tr>
<td>git diff head</td>
<td>工作区 vs 版本库</td>
</tr>
<tr>
<td>git diff –cached</td>
<td>暂存区 vs 版本库</td>
</tr>
</tbody></table>
<hr>
<p><strong>开始实验一 &gt;&gt;&gt;&gt; ：</strong></p>
<p>上一个版本之后未进行任何变更（文件未修改，未 add，未 commit）时，执行 <code>git diff</code> 命令，结果都为空：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>（工作区 vs 暂存区）git diff</td>
<td>无输出</td>
</tr>
<tr>
<td>（工作区 vs 版本库）git diff head</td>
<td>无输出</td>
</tr>
<tr>
<td>（暂存区 vs 版本库）git diff –cached</td>
<td>无输出</td>
</tr>
</tbody></table>
<p>此时查看文件内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ cat Server&#x2F;service.py</span><br><span class="line"># Git is a distributed version control system.</span><br><span class="line"># Git is free software.</span><br><span class="line"># This is a Test!</span><br><span class="line"></span><br><span class="line">print (&#39;Git is very useful!!!&#39;)</span><br><span class="line"></span><br><span class="line"># Git has a mutable index called stage.</span><br><span class="line"># Git tracks changes.</span><br></pre></td></tr></table></figure>

<hr>
<p>然后对 <code>Server/service.py</code> 进行如下变更，现在工作区内容发生变化，暂存区和版本库内容一致。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Git is a distributed version control system.</span><br><span class="line"># Git is free software.</span><br><span class="line"># This is a Test!</span><br><span class="line"></span><br><span class="line">print (&#39;Git is very useful!!!&#39;)</span><br><span class="line"></span><br><span class="line"># Git has a mutable index called stage.</span><br><span class="line"># Git tracks changes.</span><br><span class="line"></span><br><span class="line"># Git local data management test.</span><br></pre></td></tr></table></figure>

<p><strong>Result 1 &gt;&gt;&gt;&gt;：（工作区 vs 暂存区）git diff</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ git diff</span><br><span class="line">diff --git a&#x2F;Server&#x2F;service.py b&#x2F;Server&#x2F;service.py</span><br><span class="line">index 6bef824..5127360 100644</span><br><span class="line">--- a&#x2F;Server&#x2F;service.py</span><br><span class="line">+++ b&#x2F;Server&#x2F;service.py</span><br><span class="line">@@ -6,3 +6,5 @@ print (&#39;Git is very useful!!!&#39;)</span><br><span class="line"></span><br><span class="line"> # Git has a mutable index called stage.</span><br><span class="line"> # Git tracks changes.</span><br><span class="line">+</span><br><span class="line">+# Git local data management test.</span><br></pre></td></tr></table></figure>

<p><strong>Result 2 &gt;&gt;&gt;&gt;：（工作区 vs 版本库）git diff head</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ git diff head</span><br><span class="line">diff --git a&#x2F;Server&#x2F;service.py b&#x2F;Server&#x2F;service.py</span><br><span class="line">index 6bef824..5127360 100644</span><br><span class="line">--- a&#x2F;Server&#x2F;service.py</span><br><span class="line">+++ b&#x2F;Server&#x2F;service.py</span><br><span class="line">@@ -6,3 +6,5 @@ print (&#39;Git is very useful!!!&#39;)</span><br><span class="line"></span><br><span class="line"> # Git has a mutable index called stage.</span><br><span class="line"> # Git tracks changes.</span><br><span class="line">+</span><br><span class="line">+# Git local data management test.</span><br></pre></td></tr></table></figure>

<p><strong>Result 3 &gt;&gt;&gt;&gt;：（暂存区 vs 版本库）git diff –cached</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git diff --cached</span><br><span class="line"># 无输出</span><br></pre></td></tr></table></figure>

<hr>
<p>执行 <code>git add</code> 操作后，修改同步到暂存区，现在工作区和暂存区数据一致。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git add Server&#x2F;service.py</span><br></pre></td></tr></table></figure>

<p><strong>Result 1 &gt;&gt;&gt;&gt;：（工作区 vs 暂存区）git diff</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git diff</span><br><span class="line"># 无输出</span><br></pre></td></tr></table></figure>

<p><strong>Result 2 &gt;&gt;&gt;&gt;：（工作区 vs 版本库）git diff head</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ git diff head</span><br><span class="line">diff --git a&#x2F;Server&#x2F;service.py b&#x2F;Server&#x2F;service.py</span><br><span class="line">index 6bef824..5127360 100644</span><br><span class="line">--- a&#x2F;Server&#x2F;service.py</span><br><span class="line">+++ b&#x2F;Server&#x2F;service.py</span><br><span class="line">@@ -6,3 +6,5 @@ print (&#39;Git is very useful!!!&#39;)</span><br><span class="line"></span><br><span class="line"> # Git has a mutable index called stage.</span><br><span class="line"> # Git tracks changes.</span><br><span class="line">+</span><br><span class="line">+# Git local data management test.</span><br></pre></td></tr></table></figure>

<p><strong>Result 3 &gt;&gt;&gt;&gt;：（暂存区 vs 版本库）git diff –cached</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ git diff --cached</span><br><span class="line">diff --git a&#x2F;Server&#x2F;service.py b&#x2F;Server&#x2F;service.py</span><br><span class="line">index 6bef824..5127360 100644</span><br><span class="line">--- a&#x2F;Server&#x2F;service.py</span><br><span class="line">+++ b&#x2F;Server&#x2F;service.py</span><br><span class="line">@@ -6,3 +6,5 @@ print (&#39;Git is very useful!!!&#39;)</span><br><span class="line"></span><br><span class="line"> # Git has a mutable index called stage.</span><br><span class="line"> # Git tracks changes.</span><br><span class="line">+</span><br><span class="line">+# Git local data management test.</span><br></pre></td></tr></table></figure>
<hr>
<p>执行 <code>git commit</code> 操作后，修改已经同步到版本库，三区数据再次保持一致。</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>（工作区 vs 暂存区）git diff</td>
<td>无输出</td>
</tr>
<tr>
<td>（工作区 vs 版本库）git diff head</td>
<td>无输出</td>
</tr>
<tr>
<td>（暂存区 vs 版本库）git diff –cached</td>
<td>无输出</td>
</tr>
</tbody></table>
<hr>
<p><strong>开始实验二 &gt;&gt;&gt;&gt; ：</strong></p>
<p>1）对 Server/service.py 进行第一次修改：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Git is a distributed version control system.</span></span><br><span class="line"><span class="comment"># Git is free software.</span></span><br><span class="line"><span class="comment"># This is a Test!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;Git is very useful!!!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Git has a mutable index called stage.</span></span><br><span class="line"><span class="comment"># Git tracks changes.</span></span><br></pre></td></tr></table></figure>

<p>2）将其添加到暂存区：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git add Server/service.py</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="line"></span><br><span class="line">        modified:   Server/service.py</span><br></pre></td></tr></table></figure>

<p>3）对 Server/service.py 进行第二次修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Git is a distributed version control system.</span><br><span class="line"># Git is free software.</span><br><span class="line"># This is a Test!</span><br><span class="line"></span><br><span class="line">print (&#39;Git is very useful!!!&#39;)</span><br><span class="line"></span><br><span class="line"># Git has a mutable index called stage.</span><br><span class="line"># Git tracks changes of files.</span><br></pre></td></tr></table></figure>

<p>4）提交：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git commit -m <span class="string">&#x27;git tracks changes&#x27;</span></span></span><br><span class="line">[master 9046f26] git tracks changes</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">        modified:   Server/service.py</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br></pre></td></tr></table></figure>

<p>我们发现还有一次修改未被提交，我们先回顾一下操作过程：</p>
<p>第一次修改 -&gt; <code>git add</code> -&gt; 第二次修改 -&gt; <code>git commit</code></p>
<p>当你用 <code>git add</code> 命令后，在工作区的第一次修改被放入暂存区，准备提交。但是，在工作区的第二次修改并没有放入暂存区，所以，<code>git commit</code> 只负责把暂存区的修改提交了，也就是第一次的修改被提交了，第二次的修改不会被提交。</p>
<p><strong>Result 1 &gt;&gt;&gt;&gt;：（工作区 vs 暂存区）git diff</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> $ git diff</span><br><span class="line">diff --git a&#x2F;Server&#x2F;service.py b&#x2F;Server&#x2F;service.py</span><br><span class="line">index 6bef824..a17dbf0 100644</span><br><span class="line">--- a&#x2F;Server&#x2F;service.py</span><br><span class="line">+++ b&#x2F;Server&#x2F;service.py</span><br><span class="line">@@ -5,4 +5,4 @@</span><br><span class="line"> print (&#39;Git is very useful!!!&#39;)</span><br><span class="line"></span><br><span class="line"> # Git has a mutable index called stage.</span><br><span class="line">-# Git tracks changes.</span><br><span class="line">+# Git tracks changes of files.</span><br></pre></td></tr></table></figure>

<p>此时，由于第二次修改内容未同步至暂存区，所以工作区和暂存区数据不一致。</p>
<p><strong>Result 2 &gt;&gt;&gt;&gt;：（工作区 vs 版本库）git diff head</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ git diff head</span><br><span class="line">diff --git a&#x2F;Server&#x2F;service.py b&#x2F;Server&#x2F;service.py</span><br><span class="line">index 6bef824..a17dbf0 100644</span><br><span class="line">--- a&#x2F;Server&#x2F;service.py</span><br><span class="line">+++ b&#x2F;Server&#x2F;service.py</span><br><span class="line">@@ -5,4 +5,4 @@</span><br><span class="line"> print (&#39;Git is very useful!!!&#39;)</span><br><span class="line"></span><br><span class="line"> # Git has a mutable index called stage.</span><br><span class="line">-# Git tracks changes.</span><br><span class="line">+# Git tracks changes of files</span><br></pre></td></tr></table></figure>

<p>可见，第二次修改确实没有被提交。所以：如果不用 <code>git add</code> 到暂存区，那就不会加入到 <code>commit</code> 快照中。</p>
<p><strong>Result 3 &gt;&gt;&gt;&gt;：（暂存区 vs 版本库）git diff –cached</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git diff --cached</span><br><span class="line"># 无输出</span><br></pre></td></tr></table></figure>

<p>此时，第一次修改的暂存区内容已提交至版本库，所以暂存区和版本库内容是保持一致的。</p>
<hr>
<p>事实上，Stage 的引入，确实赋予了 Git 更多灵活的特性。</p>
<h3 id="Git-Reset-–Options"><a href="#Git-Reset-–Options" class="headerlink" title="Git Reset –Options"></a>Git Reset –Options</h3><p>前面我们提到过，<code>git reset</code> 版本库重置命令可以根据历史变更记录（HEAD &amp;&amp; Commit ID）来实现 “时光穿梭”（版本库重置）。</p>
<p>上文通过对 Git 本地数据管理的说明，相信你已经对 Git 分区工作原理有了深入的了解。掌握这一小节之后，通过 <code>git reset</code> 不同的参数搭配使用，可以在工作区，暂存区和版本库之间，轻松进行数据的来回切换。</p>
<p><strong>Git Reset</strong> 有三种模式（参数）：<strong>soft</strong>、<strong>mixed</strong>、<strong>hard</strong>。</p>
<p>下面分别来看使用上的区别：</p>
<hr>
<h4 id="Mode：hard"><a href="#Mode：hard" class="headerlink" title="Mode：hard"></a>Mode：hard</h4><p>该模式下，Git 会使用 &lt;HEAD or Commit ID&gt; 所对应的版本重置 Stage 区和工作区（Working Directory）。命令格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --hard &lt;HEAD or Commit ID&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>命令说明：git reset 后面加了 <code>--hard</code> 参数时，你的 stage区和工作目录里的内容会被完全重置为 &lt;HEAD or Commit ID&gt; 所对应的新位置相同的内容。</p>
<p>简言之：<strong>你的没有 commit 的修改会被全部擦掉。</strong></p>
</blockquote>
<p><strong>Demo &gt; &gt; &gt; &gt;</strong></p>
<p>例如，上一次 <code>commit</code> 之后又对文件做了一些修改：将修改后的 <code>Server/service.py</code> 文件 <code>add</code> 到 Stage；修改后的 <code>Client/request.py</code> 保留在工作区（未执行 add）。查看此时版本库状态：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        modified:   Server&#x2F;service.py</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Client&#x2F;request.py</span><br></pre></td></tr></table></figure>

<p>然后，查看 <code>git reset --hard</code> 效果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --hard HEAD^</span><br><span class="line">HEAD is now at bf2ead8 Git Local Data Managemant</span><br></pre></td></tr></table></figure>

<p>可以发现，当前版本库的 HEAD 切到上一条 commit 的同时，工作目录里的新改动（Client/request.py）和已经 add 到 stage 区的新改动（Server/service.py）也一起全都消失了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="Mode：soft"><a href="#Mode：soft" class="headerlink" title="Mode：soft"></a>Mode：soft</h4><p>该模式下，Git 会使用 &lt;HEAD or Commit ID&gt; 所对应的版本进行重置，但注意，会保留 Stage 区和工作区（Working Directory）中的内容，并且会把重置 &lt;HEAD or Commit ID&gt; 所带来的新的差异放进暂存区。命令格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --soft &lt;HEAD or Commit ID&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>命令说明：什么是「重置 HEAD 所带来的新的差异」？由于 HEAD 的移动（A –&gt; C），版本 A 到 版本 C 之间的差异即为重置 HEAD 所带来的新的差异，会将这些由版本版本重置引发的差异放入暂存区。</p>
<p>简言之：<strong>保留工作目录和暂存区内容，并把重置 HEAD 所带来的新的差异放进暂存区。</strong></p>
</blockquote>
<p>可以想象到，当我们想合并「当前节点」与「reset 目标节点」之间不具太大意义的 commit 记录（可能是阶段性地频繁提交）時，可以考虑使用 Soft Reset 来让 commit 演进线图较为清晰点。</p>
<p><strong>Demo &gt; &gt; &gt; &gt;</strong></p>
<p>例如，上一次 <code>commit</code> 之后又对文件做了一些修改：将修改后的 <code>Server/service.py</code> 文件 <code>add</code> 到 Stage；修改后的 <code>Client/request.py</code> 保留在工作区（未执行 add）。查看此时版本库状态：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        modified:   Server&#x2F;service.py</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Client&#x2F;request.py</span><br></pre></td></tr></table></figure>

<p>假设此时当前 commit 的改动内容是新增了 softtest.txt 文件。如果这时你执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --soft HEAD^</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        modified:   Server&#x2F;service.py</span><br><span class="line">        new file:   softtest.txt</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Client&#x2F;request.py</span><br></pre></td></tr></table></figure>

<p>可见，将版本库由 HEAD 重置为 HEAD^，重置 HEAD 所带来的差异为：新增了 softtest.txt 文件，故新增文件被存放到暂存区。</p>
<hr>
<h4 id="Mode：mixid"><a href="#Mode：mixid" class="headerlink" title="Mode：mixid"></a>Mode：mixid</h4><p>该模式下（默认，不加参数），Git 会使用 &lt;HEAD or Commit ID&gt; 所对应的版本进行重置，注意，会保留工作区（Working Directory）中的内容，但会清空暂存区（Stage）。命令格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --mixed &lt;HEAD or Commit ID&gt;</span><br><span class="line"># 或者</span><br><span class="line">$ git reset &lt;HEAD or Commit ID&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>命令说明：保留工作区（Working Directory）中的内容，但会清空暂存区（Stage）。工作目录的修改、暂存区的内容以及由 reset 所导致的新的文件差异，都会被放进工作目录。</p>
<p>简言之：<strong>把所有差异都混合（mixed）放在工作目录中。</strong></p>
</blockquote>
<p><strong>Demo &gt; &gt; &gt; &gt;</strong></p>
<p>例如，上一次 <code>commit</code> 之后又对文件做了一些修改：将修改后的 <code>Server/service.py</code> 文件 <code>add</code> 到 Stage；修改后的 <code>Client/request.py</code> 保留在工作区（未执行 add）。查看此时版本库状态：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        modified:   Server&#x2F;service.py</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Client&#x2F;request.py</span><br></pre></td></tr></table></figure>

<p>假设此时当前 commit 的改动内容是新增了 softtest.txt 文件。如果这时你执行不带参数的 reset：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> $ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Client&#x2F;request.py</span><br><span class="line">        modified:   Server&#x2F;service.py</span><br><span class="line"></span><br><span class="line">Untracked files:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br><span class="line">      softtest.txt</span><br></pre></td></tr></table></figure>

<p>完美~</p>
<hr>
<h2 id="Undo-Edit"><a href="#Undo-Edit" class="headerlink" title="Undo Edit"></a>Undo Edit</h2><p>如何撤销修改？ &gt;&gt;&gt;</p>
<p><strong>3.2 Data Flow In Git 实验二</strong> 中我们对 <code>Server/service.py</code> 文件做了两次修改，第一次修改为正确修改已被提交（commit）。第二次修改未提交（add），提交（add）前我们突然发现修改为错误修改：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat Server/service.py</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git is a distributed version control system.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git is free software.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is a Test!</span></span><br><span class="line"></span><br><span class="line">print (&#x27;Git is very useful!!!&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git has a mutable index called stage.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git tracks changes of files.</span></span><br></pre></td></tr></table></figure>

<p>我们能想到的直接的纠正方法是手动把文件恢复到上一个版本的状态。但我们查看此时版本库状态：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">        modified:   Server/service.py</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br></pre></td></tr></table></figure>

<p><strong>CMD 7 –&gt;&gt;&gt; git checkout – file</strong></p>
<p>我们发现，Git 提示可以通过 <code>git checkout -- file</code> 可以丢弃工作区的修改，指令如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git checkout -- Server/service.py</span></span><br></pre></td></tr></table></figure>

<p>命令 <code>git checkout -- Server/service.py</code> 意思是：把 <code>service.py</code> 文件在工作区的修改全部撤销，这里有两种情况：</p>
<ul>
<li>第一种是 service.py 自修改后还没有被放到暂存区，撤销修改就回到和版本库一模一样的状态；</li>
<li>第二种是 service.py 已经添加到暂存区后又作了修改，撤销修改就回到添加到暂存区后的状态。</li>
</ul>
<blockquote>
<p>简单地说：<code>git checkout -- file</code> 会让文件 file 回到上一次 <code>git commit</code> 或 <code>git add</code> 时的状态。</p>
</blockquote>
<p>可以发现，丢弃工作区的修改之后 service.py 文件又恢复到之前的内容了：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat Server/service.py</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git is a distributed version control system.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git is free software.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is a Test!</span></span><br><span class="line"></span><br><span class="line">print (&#x27;Git is very useful!!!&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git has a mutable index called stage.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git tracks changes.</span></span><br></pre></td></tr></table></figure>

<p>注意：<code>git checkout -- file</code> 命令中的参数 <code>--</code> 很重要，没有 <code>--</code>，就变成了 “切换到另一个分支” 的命令，后面的分支管理中会再次遇到 <code>git checkout</code> 命令。</p>
<blockquote>
<p>还能怎么操作可以实现上述功能？！！上一小节介绍的 <code>git reset</code> 也可以实现上述撤消操作。如下：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --hard HEAD</span><br><span class="line">HEAD is now at 04aee1b git tracks changes</span><br></pre></td></tr></table></figure>

<hr>
<p>这里我们再来尝试 <code>git checkout --</code> 的第二种情况（变更已经 add 到暂存区）：将 <code>service.py</code> 文件内容修改为上述中第二次修改内容，如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Git is a distributed version control system.</span></span><br><span class="line"><span class="comment"># Git is free software.</span></span><br><span class="line"><span class="comment"># This is a Test!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;Git is very useful!!!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Git has a mutable index called stage.</span></span><br><span class="line"><span class="comment"># Git tracks changes of files.</span></span><br></pre></td></tr></table></figure>

<p>然后将上述修改添加至暂存区：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git add Server/service.py</span></span><br></pre></td></tr></table></figure>

<p>添加后再进行修改，内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Git is a distributed version control system.</span></span><br><span class="line"><span class="comment"># Git is free software.</span></span><br><span class="line"><span class="comment"># This is a Test!</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;Git is very useful!!!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Git has a mutable index called stage.</span></span><br><span class="line"><span class="comment"># Git tracks changes of files.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Git Second tracks changes of files.</span></span><br></pre></td></tr></table></figure>

<p>随后，查看此时文件状态</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span><br><span class="line">        modified:   Server&#x2F;service.py</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Server&#x2F;service.py</span><br></pre></td></tr></table></figure>

<p>此时，我们发现修改有误，需要撤销工作区中文件内容，指令如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> $ git checkout -- Server/service.py</span></span><br></pre></td></tr></table></figure>

<p>查看文件内容，发现撤销修改回到添加到暂存区后的状态（仅仅撤销了第二次修改的内容）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cat Server/service.py</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git is a distributed version control system.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git is free software.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This is a Test!</span></span><br><span class="line"></span><br><span class="line">print (&#x27;Git is very useful!!!&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git has a mutable index called stage.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Git tracks changes of files.</span></span><br></pre></td></tr></table></figure>

<p>事实上，我们第一次已经 <code>add</code> 到 暂存区的内容也是有问题的，怎么办？</p>
<p><strong>git reset HEAD file</strong> 可以帮我们直接清楚暂存区内容。</p>
<p>如果你想将当前文件的修改从暂存区移除去，可以做如下操作：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">git reset HEAD Server/service.py</span><br><span class="line">Unstaged changes after reset:</span><br><span class="line">M       Server/service.py</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> git status</span></span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line">        modified:   Server/service.py</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br></pre></td></tr></table></figure>

<p>然后，我们对比一下，工作区和暂存区中 <code>Server/service.py</code> 文件差异：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git diff</span></span><br><span class="line">diff --git a/Server/service.py b/Server/service.py</span><br><span class="line">index 6bef824..a17dbf0 100644</span><br><span class="line">--- a/Server/service.py</span><br><span class="line">+++ b/Server/service.py</span><br><span class="line">@@ -5,4 +5,4 @@</span><br><span class="line"> print (&#x27;Git is very useful!!!&#x27;)</span><br><span class="line"></span><br><span class="line"><span class="meta"> #</span><span class="bash"> Git has a mutable index called stage.</span></span><br><span class="line"><span class="meta">-#</span><span class="bash"> Git tracks changes.</span></span><br><span class="line">+# Git tracks changes of files.</span><br></pre></td></tr></table></figure>

<p>现在，上一小节的第二次修改也不想要了，怎么办？指令如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git checkout -- Server/service.py</span></span><br></pre></td></tr></table></figure>

<p>当然了，使用 <code>git reset</code> 可以很容易实现上述“复杂”的过程，但这里主要是为了引入 <code>git reset HEAD file</code>，掌握这一方法可以很快清空暂存区。</p>
<hr>
<p><strong>CMD 8 –&gt;&gt;&gt; git switch &amp;&amp; git restore</strong></p>
<p>我们知道，<code>git checkout</code> 命令身兼数职（切换分支、文件撤回…），从 <code>Git 2.23</code> 版本开始引入了两个新的命令来分担 git checkout 功能：</p>
<ul>
<li>git switch：切换分支</li>
<li>git restore：文件撤回（检出）</li>
</ul>
<blockquote>
<p>git switch 功能这里不进行详细介绍，在介绍 Git 分支功能时再详解。</p>
</blockquote>
<p><strong>git restore 命令详解：</strong></p>
<ol>
<li>git restore file&gt;&gt;&gt; 指令使得在工作空间但是不在暂存区的文件撤销更改(内容恢复到没修改之前的状态)；【另一种说法：用暂存区或者版本库中的文件覆盖本地文件的修改可以达到回退修改的目的】</li>
<li>git restore –staged file&gt;&gt;&gt; 的作用是将暂存区的文件从暂存区撤出，但不会更改文件的内容。【另一种说法：使用版本库中的文件覆盖暂存区的文件，达到回退 git add 命令的目的】</li>
</ol>
<hr>
<h2 id="Delete-File"><a href="#Delete-File" class="headerlink" title="Delete File"></a>Delete File</h2><p>前面我们接触的修改文件都是新建、修改等。那么，Git 中是如何管理文件删除的？？？</p>
<p>下面我们通过一个删除实例来看 Git 如何管理删除，先添加一个新文件 git_rm_test.txt 到 Git 并且提交：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ touch git_rm_test.txt</span><br><span class="line">$ git add git_rm_test.txt</span><br><span class="line">$ git commit -m &#39;Add git_rm_test.txt&#39;</span><br><span class="line">[master 6516e48] Add git_rm_test.txt</span><br><span class="line">  1 file changed, 0 insertions(+), 0 deletions(-)</span><br><span class="line">  create mode 100644 git_rm_test.txt</span><br></pre></td></tr></table></figure>

<p>然后我们删除 git_rm_test.txt 文件。这时 Git 会跟踪删除文件操作，工作区和版本库就不一致了。此时我们来看版本库状态，会发现 Git 已经知道了我们的删除操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add&#x2F;rm &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">        deleted:    git_rm_test.txt</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and&#x2F;or &quot;git commit -a&quot;)</span><br></pre></td></tr></table></figure>

<p>  此时我们面临两个选择：一是确实要从版本库中删除该文件；那就用命令 <code>git rm(add) file</code> 删掉，并且 <code>git commit</code> 提交：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git rm git_rm_test.txt</span><br><span class="line">rm &#39;git_rm_test.txt&#39;</span><br><span class="line"></span><br><span class="line">  $ git commit -m &#39;rm git_rm_test.txt&#39;</span><br><span class="line">[master 4f15f79] rm git_rm_test.txt</span><br><span class="line">  1 file changed, 0 insertions(+), 0 deletions(-)</span><br><span class="line">  delete mode 100644 git_rm_test.txt</span><br></pre></td></tr></table></figure>

<p>另一种情况是删错了，因为版本库里还有呢，所以可以很轻松地把误删的文件恢复到最新版本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -- git_rm_test.txt</span><br></pre></td></tr></table></figure></div><div class="article-licensing box"><div class="licensing-title"><p>Git 使用指南之时光穿梭机</p><p><a href="https://www.orangeshare.cn/2017/07/02/git-shi-yong-zhi-nan-zhi-shi-guang-chuan-suo-ji/">https://www.orangeshare.cn/2017/07/02/git-shi-yong-zhi-nan-zhi-shi-guang-chuan-suo-ji/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Waldeinsamkeit</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2017-07-02</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-03-05</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Git/">Git</a><a class="link-muted mr-2" rel="tag" href="/tags/Github/">Github</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2017/07/03/git-shi-yong-zhi-nan-zhi-yuan-cheng-cang-ku/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Git 使用指南之远程仓库</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2017/07/01/git-shi-yong-zhi-nan-zhi-chu-shi/"><span class="level-item">Git 使用指南之初识</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Waldeinsamkeit"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Waldeinsamkeit</p><p class="is-size-6 is-block">Web, AI Engineer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Galactic System</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">34</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">17</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/TheNightIsYoung" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="DockerHub" href="https://hub.docker.com/"><i class="fab fa-docker"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Gitee" href="https://gitee.com/explore"><i class="fab fa-gofore"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="MDEditor" href="http://www.mdeditor.com/"><i class="fab fa-canadian-maple-leaf"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="WangYiYun" href="https://music.163.com/"><i class="fas fa-headphones-alt"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#File-Modification-In-Repo"><span class="level-left"><span class="level-item">1</span><span class="level-item">File Modification In Repo</span></span></a></li><li><a class="level is-mobile" href="#Time-Shuttle"><span class="level-left"><span class="level-item">2</span><span class="level-item">Time Shuttle</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#变更历史记录"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">变更历史记录</span></span></a></li><li><a class="level is-mobile" href="#时空穿梭"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">时空穿梭</span></span></a></li><li><a class="level is-mobile" href="#HEAD-amp-amp-Commit-Id"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">HEAD &amp;&amp; Commit Id</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Git-Stage"><span class="level-left"><span class="level-item">3</span><span class="level-item">Git Stage</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Git-Local-Data-Management"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Git Local Data Management</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Working-Directory"><span class="level-left"><span class="level-item">3.1.1</span><span class="level-item">Working Directory</span></span></a></li><li><a class="level is-mobile" href="#Repository"><span class="level-left"><span class="level-item">3.1.2</span><span class="level-item">Repository</span></span></a></li><li><a class="level is-mobile" href="#Stage"><span class="level-left"><span class="level-item">3.1.3</span><span class="level-item">Stage</span></span></a></li><li><a class="level is-mobile" href="#Git-版本控制原理"><span class="level-left"><span class="level-item">3.1.4</span><span class="level-item">Git 版本控制原理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Data-Flow-In-Git"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Data Flow In Git</span></span></a></li><li><a class="level is-mobile" href="#Git-Reset-–Options"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Git Reset –Options</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Mode：hard"><span class="level-left"><span class="level-item">3.3.1</span><span class="level-item">Mode：hard</span></span></a></li><li><a class="level is-mobile" href="#Mode：soft"><span class="level-left"><span class="level-item">3.3.2</span><span class="level-item">Mode：soft</span></span></a></li><li><a class="level is-mobile" href="#Mode：mixid"><span class="level-left"><span class="level-item">3.3.3</span><span class="level-item">Mode：mixid</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#Undo-Edit"><span class="level-left"><span class="level-item">4</span><span class="level-item">Undo Edit</span></span></a></li><li><a class="level is-mobile" href="#Delete-File"><span class="level-left"><span class="level-item">5</span><span class="level-item">Delete File</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="When Art Meets Tech" height="28"></a><p class="is-size-7"><span>&copy; 2022 Waldeinsamkeit</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>